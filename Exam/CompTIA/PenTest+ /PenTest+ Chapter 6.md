# CompTIA® PenTest+® Certification For Dummies®, 2nd Edition

# Chapter 6

## Understanding Wireless Terminology

Wireless Agencies

- IEEE: Creating different wireless networking standards - 802.11a,b,g,nc
- Wi-Fi Alliance: Ensuring compatibility and interoperability of wireless components.
- Federal Communication Commision (FCC): Regulating the use of wireless devices and frequencie
  - 3 ranges for public use: 900 MHz, 2.4 GHz, 5 GHz. If you looking to implement a wireless solution out of those freq range, you must acquire a license to do from FCC.

Wireless LAN Frequencies

- Channels 1, 6, 11 doesn't overlap 

Wireless Network Card

- Ensure supported by Kali Linux
- Support packet injection; Able to monitor all traffic on wireless network and inject packets onto network.

Wireless Access Point

- Device with antennas to send and receive wireless traffic as well as a network port to connect the access point to the wired network.
  - Allows systems on wireless network to access wired network, vice versa.
 
SSID

- Service Set Identifier (SSID): Acts as a name for the wireless network.
- A must for wireless clients to connect to, need specify name of the wireless network/SSID.

Wireless Clients

- Systems that have a wireless network card installed and have been configured to connect to wireless AP or other wireless client directly.
- When Wireless Client access a device on wired network (printer/server), info is sent to wireless AP from Wireless client and then onto wired network.

Type of Wirless networks: Two different netowrk Topologies mode

- Ad hoc mode: Do not have an Access poinnt on network, Wireless devices connect directly to one another in a peer to peer type of configuration.
- Infrastructure mode: Wireless client and devices connect to a wireless AP by the SSID and access the wireless network thru AP.

#

## Introducing Wireless Standards

![image](https://github.com/user-attachments/assets/84e46515-01bf-4ffa-8718-56960ff140ce)

#

## Looking at Wireless Configuration and Troubleshooting

Basic Service Set (BSS): 
- Wireless network uses single AP with an SSID
- AP connected to wired network with unique SSID = Infrastructure Basic Service Set (IBSS)

Extended Service Set (ESS):
- Cover larger area with multiple AP that uses same SSID.
- Must have: same SSID, AP must overlap coverage areas by 10% or more, each wireless AP must be configured for different Channel. 


Troubleshooting Wireless Networks 

- Wrong SSID: First setting to check when client is having trouble connecting to wireless network. Ensure the client is connected to the correct SSID.
- Wrong Encryption Settings: Next Step ensure you enable the same encryption protocol configured on the AP and you have specified the correct encryption key.
- Not Authorized to Connect: After verified all settings, if client has not connected to this network in past, its possible that client is not authorized to connect. Most wireless networks limits who can connect by MAC address, so you need to get the client's MAC address added to the AP's MAC address filter list.
- Interference from a cordless phone: Experiencing intermittent problem with losing connection to wireless network, trouble might be interference with device that uses same frequency; cordless phone. Resolution: change the channel on wireless network to use different frequency than the phone; ensure the phones uses different freq than 2.4 freq range.

#

## Implementing Wireless Security Practices

Change the SSID
- Most wireless AP have default SSID, makes it easy for someone to connect your wireless network. To make it harder for people, alter SSID from default value to something unique and not easily guessed.

Disable SSID Broadcasting:
- By default, SSID is configurated to broadcast SSID name out on the network.
- Configure the AP to not broadcast the SSID. Client will not see your wireless network when they browse for wireless networks.
- Still unsecured: Tools like `Kismet` can still identify wireless network even SSID broadcast is dsiabled.
  - Disabling SSID broadcast = keeps honest folks out.
 
Restrict by MAC
- Configure AP with list of MAC addresses that are allowed to connect to wireless network.
- Any systems that are not in the listed of MAC address filtering is denied access to network when attempted to connect.
- Still unsecured: Tools like `Kismet` can view the list of clients and MAC addresses that are connected to your network. Hackers can then spoof the address so that it looks like traffic from the filtered list.

Enable Encryption
- Configuring AP for an encryption protocol, specify a key/passphrase, that is required by anyone connecting to network.
- Anyone connecting with that key are able to access the wireless network, all traffic from wireless client to the AP is encrypted.
- Benefits: Anyone who knows passphrase/encryption key can connect. Clients that have been configured with same encryption key are sending/receiving encrypted traffic with AP.

Use Certificate-based security
- Dramatically improve security of wireless environment by using certificate-base authentication.
- Certificates are installed on client's systems who then present that cert to the AP to gain access to Wireless network.

Encryption Protocols

Wired Equivalency Privacy (WEP)
- Popular with 802.11b devices.
- Uses preshared key assigned on the AP and client to encrypt and decrypt traffic (Required for Clients to know the key to connect).
- Supports: 64 bit or 128 bit encryption, uses RC4 symmetric encryption protocol.
- WEP encryption is easily cracked and should not be used.

Wi-Fi Protected Access (WPA)
- Created by Wi-Fi Alliance.
- Uses Temporal Key Integrity Protocol (TKIP): Protocol that changes encryption key with every packet sent to make it harder for hackers to crack the key.
- WPA have 2 modes:
  - Personal: WPA-PSK (PSK = Preshared key), uses shared key as a starting value then changd with each packet. Personal mode is popular with home networking/small office environments.
  - Enterprise: uses central server to authenticate anyone connecting to network. Central server that wireless AP uses for authentication known as Remote Authentication Dial-In User Service (RADIUS) server. Network access = 802.1x Standard
 
Wi-Fi Protected Access 2 (WPA2)
- Updated version of WPA added some improvement; uses AES or Advanced Encryption Standard protocol, not cracked yet.
- Supports: 128 bit, 192 bit, 256 bit encryption
- Supports: Personal and Enterprise modes

Wi-Fi Protection Access 3 (WPA3)
- Released in 2018.
- Supports: Personal and Enterprise modes
  - Personal mode uses AES-128 bit encryption
  - Encryption mode uses AES-192 bit encryption
- Improvements helping prevent attacks that's against WPA2 protocol:
  - Simultaneous Authentication of Equals (SAE): Attck against WPA2 involve using handshake traffic to crack encryption, WPA3 implemented SAE authentication method, allowing mutual authentication of AP and wireless client (AP authenticates clients and client authenticates AP).
  - Session key: WPA3 uses unique session keys in encryption process so wireless client cannot decrypt traffic of another wireless client.

#

## Exploiting Wireless Vulnerabilities

Exam will have scenarios related to exploiting 802.11 wireless adn radio freq (RF) based vuln, have to identify the type of attack.

### Attack Methods

Eavesdropping
- Process of capturing the traffic, making a copy, so it can be read if its not encrypted or cracking the encrytion key if its encrypted.

Data Modification
- MiTM attack/On-Path attack: intercept traffic and then modify the traffic before forwarding it to wireless AP.

Data Corruption
- Involves altering or corrupting the data so that its not readable by destination system.

Relay Attack
- When attacker captures a wireless signal then sends it somewhere else (without looking at it).
- Commonly used to compromise vehicle key fobs, using a special transmitter that could relay the signal from the key fob of the car to attacker to open the door of the car without needing the car key.

Spoofing
- Altering a source address; Can be Source MAC address or Source IP address of a packet, or Source Email Address of email message.
- Common in wireless attack that attacker modifies its source MAC address in order to bypass MAC filtering on wireless AP.

Deauthentication
- Common because in order to crack the wireless encryption, that attacker needs to capture thru eavesdropping authentication traffic.
- If user already have authentication to AP, attacker would not be able to capture the authentication traffic.
- Attacker needs to deauthenticate the wireless clients, force them to authenticate again and enables the attacker to capture the traffic.

Jamming
- Purposely block or interferes with the wireless transmission.
- Could be done to act as a DoS attack against wireless network.

Capturing handshakes
- Handshake traffic occurs during inital connection to wireless network can be vuln to cryptography attacks.
- Capturing intial handshake traffic is critical to many wireless attacks.

On-path Attack
- MiTM attack, critical to captureing wireless traffic so that wireless encryption can be cracked.

### Tools Used to perform the different attack Methods

Wireless network card
- Perform PenTest on Wireless network, need to have a wireless network card that is detected by your OS/Linux and can be placed in monitor mode.
- Monitor mode = allow you to view all wireless network traffic.

Amplified Antenna
- Special antenna that allows extend range of wireless signal.

Aircrack-ng: Suite of tools available on Linux allows you to exploit wireless networks
- Aircrack-ng: Used to crack encryption keys for WEP, WPA, WPA2.
- Airmon-ng: Used to place wireless network card in monitor mode.
- Aireplay-ng: Used to perform packet injection.
- Airedump-ng: Used to capture wireless Traffic
- Airbase-ng: Used to create a fake AP for MiTM attack.

Wifite
- Automated wireless testing tool that comes with Linux.
- Automates number of wireless tools that you can manually use yourself: cracking WEP, WPA, WPA2 and performing WPS attack (Wi-Fi Protected Setup).

Kismet
- Wireless network scanner that can be used to detect wireless networks and clients that are connected to wireless network.
- Can see number of details about the wireless network: SSID, channel, MAC address of the wireless AP
- Can also see: MAC addresses of client connected and number of packets being sent by clients.


### 802.11 Wireless Vulnerabilities

Evil Twin Attack
- Hacker sets up a fake ap that impersonates a real AP for network users to access.
- Fake AP = hacker's laptop configurated to look and act like a real AP, accepting traffic from unsuspecting users and then passing traffic on to real access point.
- Benefit = hacker can intercept all traffic coming from wireless client

Karma Attack
- Variation of Evil Twin
- Fake access point configures itself to appear as any of the AP found in the client's preferred network list.
- Possible because wireless client broadcasts out its preferred network list (PNL) for all AP to seem including fake AP.

Downgrade Attack
- System gets other party to switch to a less secure type of connection in order to communicate.
- Less secure communication channel is supported by the devices so compatible with older components.

Captive Portal
- Webpage that appears that ask you for login credentials when you connect to wireless network.
- Guest wireless network in airports or cafes.
- Captive portal attack = attacker sets up a captive portal for evil twin network that is used to prompt the user for the user's password.

Deauthentication Attacks
- Hacker forces the AP to disconnect a wireless client from the AP.
- Hacker will start capturing wireless traffic so that the hacker can capture the authentication traffic (handshake) when the client reconnects to AP.
- Hacker can use captured traffic to help crack the encryption keys.
- Hacker will use airplay-ng command to send a message to AP, giving MAC address of the client to deauthenticate.


#

# For the Exam

- Single AP creates BSS or Basic Service Set.
- PenTest tools uses parameter: `bssid`, reference the MAC (Media Access Control) address of the AP.
- WEP uses RC4 as encryption algorithm
- WPA uses TKIP and has a key rotation feature
- WPA2 uses AES as encryption algorithm
- Evil twin = fake AP set up by hacker to accpet traffic from unsuspecting users
- Karma attack = fake AP that configures itself as an AP from client's preferred network list.
