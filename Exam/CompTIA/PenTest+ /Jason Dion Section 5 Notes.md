# Scanning and Enumeration (OBJ 2.2 and 2.3)

## Overview

After conducting initial footprinting and passive reconnaissance, the next step in penetration testing involves active reconnaissance. This process includes scanning and enumerating the target organization's systems to identify hosts, open ports, services, users, domain names, and URLs.

## Types of Scans

### Discovery Scan
- **Purpose:** Identify hosts that are online and determine open ports and services.
- **Methods:** 
  - **Ping Scan:** Identifies online hosts within a network.
  - **Port Scan:** Determines which ports and services are open on a host.

### Enumeration
- **Purpose:** Gather detailed information about identified hosts and their open ports.
- **Methods:** 
  - **Tools:** Nmap (command line) and Zenmap (GUI).
  - **Process:** 
    - Conduct a ping scan to find online hosts.
    - Perform a quick scan to identify open ports.
    - Execute an intensive scan to determine running services and their versions.

## Scanning Tools

### Nmap
- **Description:** A command line tool for various types of scans.
- **Capabilities:** 
  - Syntax-based setup for different scans.
  - Conducts ping scans, quick scans, and intense scans.

### Zenmap
- **Description:** A graphical interface for Nmap.
- **Capabilities:** 
  - Dropdown menus for selecting scan types.
  - Easy configuration of scans via domain names or IP ranges.

## Detailed Enumeration and Fingerprinting

### Intensive Scanning
- **Process:** 
  - Identify services running on open ports.
  - Determine exact software versions.
  - Example: Discover vsftpd version 2.3.4 running on port 21.

### Operating System Identification
- **Method:** Analyze system responses to queries.
- **Tools:** Zenmap, Nmap.
- **Example:** Identify a target system as Windows XP with specific service packs.

### Manual Banner Grabbing
- **Tools:** Netcat, wget, telnet.
- **Process:** 
  - Connect to a port and observe the service's response.
  - Example: Use Netcat to identify Apache web server version 2.2.16 on Debian Linux.

- `GET/HTTP/1.1`
- `wget <domain name or IP address> -S` 

### Packet Crafting
- **Tools:** Nmap, Zenmap, hping, Netcat, Ncat.
- **Process:** 
  - Modify packet headers to elicit specific responses.
  - Example: Use hping to send crafted SYN packets and analyze responses in Wireshark.

- `Nmap -sV <target domain or IP> -p <port number>`
- `hping3 --syn -p 80 192.168.1.15`

### Packet Analysis
- **Tool:** Wireshark.
- **Process:** 
  - Capture and analyze network packets.
  - Example: Identify a Microsoft ESMTP server and its software version.

## Summary

- **Scanning:** A generic process to identify online hosts and open ports.
- **Enumeration:** A more detailed process to gather information about services and software versions.
- **Fingerprinting:** The most detailed process to capture specific information about hosts or services.

By using tools like Nmap, Zenmap, Netcat, and Wireshark, penetration testers can conduct thorough scanning, enumeration, and fingerprinting to identify vulnerabilities and plan their exploitation strategies effectively.

#

# Conducting Enumeration (OBJ 2.3)

# Using Zenmap for Scanning and Enumeration

In this video, I'm going to demonstrate how to use Zenmap to conduct scanning and enumeration. For this example, I am connected directly to the local area network of my victim machines.

## Initial Scan: Ping Scan
1. **Ping Scan Setup**: 
   - Target network: `192.168.56.0/24`
   - Zenmap shows the Nmap command syntax.
   - Profile selected: Ping scan (`-sn`).
2. **Ping Scan Execution**:
   - Click on **Scan**.
   - Results: 4 hosts up (server, DHCP server, 2 virtual machines, and Kali Linux box).

## Further Scans
1. **Quick Scan**:
   - Target machines: `192.168.56.100` and `192.168.56.101`.
   - Quick scan checks common ports.
   - Results for `101`: Several open ports indicating potential vulnerabilities.
   - Results for `100`: All ports filtered.
   - Identified services: FTP, SSH, Telnet, RPC bind, Samba.

2. **Intense Scan**:
   - Profile selected: Intense scan.
   - Targets: `192.168.56.100` and `192.168.56.101`.
   - Scans for open and closed ports and attempts basic enumeration.
   - Results for `101`: Detailed service versions (e.g., VSftpd, Apache, Samba).

## Analysis of Results
1. **Machine Identification**:
   - `101`: Likely a Linux machine with Microsoft services.
   - `100`: Windows machine with firewall blocking many ports.
   
2. **Firewall Configuration Check**:
   - Windows firewall settings checked.
   - Exception for file and print sharing enabled.

3. **Rescan of Windows Machine**:
   - Quick scan after firewall exception.
   - Identified open ports: `139` and `445`.

4. **Detailed Enumeration**:
   - Intense scan on `100`.
   - Identified OS: Windows XP or 2000.
   - Additional information: NetBIOS details, SMB, trace route.

## Conclusion
- **Scanning Strategy**:
  - **Quiet Scans**: Minimal detection, realistic threat emulation.
  - **Loud Scans**: High detection, easier defender training.
  - Choice depends on assessment goals and method during the hack.

- **Tool Utilization**:
  - Understanding and customizing tools like Zenmap/Nmap for specific needs is crucial for effective scanning and enumeration.
