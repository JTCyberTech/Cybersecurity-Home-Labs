# Information Gathering (OBJ 2.1)

# Information Gathering in Penetration Testing

## Overview
Information gathering, also known as reconnaissance or footprinting, is the initial step in the second phase of penetration testing. This phase involves systematically locating, gathering, identifying, and recording information about the target organization, including hosts, servers, systems, and employees. This information is essential for planning attacks and exploits in subsequent phases.

## Methods of Information Gathering

### Passive Reconnaissance
- **Internet Research:** Using search engines, press releases, job postings, resumes, and social media to gather information.
- **Social Engineering:** Techniques like phishing (email), vishing (voice calls), and in-person deception to trick users into revealing information.
- **Dumpster Diving:** Searching through an organization's trash to find useful information like usernames, phone lists, and organizational charts.
- **Email Harvesting:** Collecting email addresses using specialized search queries.

### Information Collected
- **Contact Information:** Phone numbers, email addresses, and names.
- **Organizational Details:** Positions, security-related information, and system details.
- **Technical Information:** Operating systems (Windows, Linux), web servers (Apache, IIS), and other infrastructure details.

## Documentation and Collaboration
- **Cataloging Findings:** Use internal wikis or spreadsheets to document and share gathered information with the team.
  - **Spreadsheet Example:** 
    - **Technique Used:** LinkedIn Resume
    - **Assets Identified:** Types of servers (e.g., 200 Linux servers running Red Hat and SUSE Linux)
    - **Tools for Enumeration:** Nmap scans for identifying public-facing servers
    - **Findings and Results:** Document server IPs and open ports (e.g., 66.55.44.33 with ports 80, 443, and 22 open)
    - **Next Steps:** Plan further tests like banner grabbing or vulnerability scans

## Example Scenario
- **Finding Information from Resumes:** Analyze a found resume for details about the organization's infrastructure.
  - **Example Resume Details:** 
    - **Current Position:** Linux Administration Systems Analyst at ABC Energy
    - **Technical Details:** Maintains over 200 Linux servers, uses VMware's ESXi servers for virtualization

## Team Collaboration
- **Role Specialization:** Different team members focus on specific tasks, increasing efficiency.
  - **Information Gathering Ninja:** Focus on gathering data.
  - **Enumeration and Vulnerability Scanning:** Other team members use the gathered data for further analysis.
  - **Custom Exploits:** Senior testers develop exploits based on findings.

By effectively gathering and documenting information during reconnaissance, penetration testing teams can enhance their efficiency and effectiveness in identifying and exploiting vulnerabilities.

#

# Open-Source Intelligence (OSINT) (OBJ 2.1)

# Open Source Intelligence (OSINT) in Penetration Testing

## Overview
Open Source Intelligence (OSINT) involves collecting and analyzing publicly available information to produce actionable intelligence. This data can be gathered from various sources during the passive reconnaissance phase of penetration testing.

## Sources of OSINT

### Internet and Public Records
- **Social Media, Blogs, Newspapers**
- **Governmental Records, Academic and Professional Publications**
- **Company Websites (e.g., About Us pages, Investor Relations portals)**

### Example: Press Releases
- **Actionable Intelligence:** Information on mergers or organizational changes can be used for social engineering attacks.
- **Physical Penetration Testing:** Knowledge of a merger can allow an attacker to impersonate employees from the merging company to gain physical access.

### Detailed OSINT Collection
- **Investor Relations Sites:** Provides detailed information on executives, their backgrounds, and contact information.
  - **Example:** Investors.Udemy.com contains tabs for press releases, financial information, and executive profiles.

### Job Listings and Metadata
- **Company About Us Pages:** Detailed info on company executives.
- **Investor Relations Sites:** Names, phone numbers, emails, and positions of key personnel.

### Social Media and Blogs
- **Workplace Culture and Tempo:** Understanding if employees are working remotely or in-office.
- **Employee Sentiment:** Insights into employee satisfaction and workplace dynamics.

### Physical Reconnaissance
- **Employee Habits:** Identifying places employees frequent can aid in physical penetration tests (e.g., cloning proximity badges at local bars).

## Using OSINT for Social Engineering
- **Social Engineering Attacks:** Leveraging gathered information for phishing, vishing, or in-person deception.
- **Crafting Whaling Emails:** Detailed emails targeting busy executives based on their profiles and habits.

## Cataloging and Analyzing Information
- **Documentation:** Use spreadsheets or internal wikis to organize collected data.
  - **Key Details to Record:**
    - Employee roles, job titles, and responsibilities
    - Teams and departments
    - Contact information (phone numbers, email addresses)
    - Technical infrastructure and security training programs
    - Employee and management mindset and relationships

### Example: Hybrid Password Cracking
- **Personal Information for Word Lists:** Using personal details (e.g., pet names, birthdates) to create word lists for password cracking.

## Conclusion
OSINT provides valuable insights that can be turned into actionable intelligence for penetration testing. By systematically gathering and analyzing publicly available information, penetration testers can enhance their reconnaissance efforts and effectively plan their engagement strategies.

#

# Social Media Scraping (OBJ 2.1)

### Leveraging Social Media for Open Source Intelligence

**Social Media as a Source of OSINT**
- Social media platforms such as Twitter, Facebook, LinkedIn, YouTube, Instagram, Reddit, and TikTok can reveal a wealth of information about an organization and its employees.
- Organizations often post marketing content, behind-the-scenes pictures, and videos that may unintentionally reveal sensitive information.

**Example of Information Disclosure**
- An employee's Instagram post might inadvertently display sensitive corporate documents on a computer screen in the background.

**Employee Accounts**
- Employees often have both professional and personal social media accounts. Personal accounts can reveal interests, behaviors, and even personally identifiable information.

**LinkedIn for OSINT**
- LinkedIn is a particularly valuable source of information:
  - **Company Page**: Offers insights into employee count, growth, and other key metrics.
  - **Insights Tab**: Provides data on workforce distribution and company growth rates, which can indicate potential security vulnerabilities during rapid expansion.
  - **Life Tab**: Shows company culture, employee testimonials, and photos.
  - **People Tab**: Lists employees, their locations, educational background, and roles, allowing for targeted research on specific individuals.
  - **Jobs Tab**: Reveals job postings that can indicate the company's technical stack and security posture.

**Example: Udemy on LinkedIn**
- **Company Insights**: 
  - Udemy has grown 62% in the past two years.
  - Major workforce areas include education and engineering.
- **Jobs Tab**:
  - Reveals technical infrastructure, such as AWS, GCP, VMware, Terraform, and more.
  - Confirms primary use of AWS for cloud services.

**Utilizing Job Postings**
- Job postings can reveal:
  - Department and team structures.
  - Technical capabilities and software architecture.
  - Security systems and tools in use.
- Example: Udemy's job postings reveal the use of AWS and GCP, indicating a multi-cloud infrastructure with a primary focus on AWS.

**Other Platforms for Job Postings**
- Monster, ZipRecruiter, Indeed, Glassdoor, and others also provide valuable information about a company's hiring needs and technical capabilities.

**Summary**
- Social media and job postings offer rich sources of open source intelligence.
- Detailed analysis of this information can assist in penetration testing and other security engagements by revealing organizational structures, technical stacks, and potential vulnerabilities.

#

# OSINT Tools (OBJ 2.1)

## Overview of OSINT Tools

Open-source intelligence (OSINT) tools are crucial during the reconnaissance phase of penetration testing. They help gather actionable intelligence from publicly available sources, allowing for more precise and targeted attacks. OSINT does not raise alerts at the target organization, as it relies solely on public data.

### Key OSINT Sources

- **Public Websites**: Includes the target's own website.
- **WHOIS Database**: Provides domain ownership details.
- **Public DNS Servers**: Offers information on DNS records, subdomains, and associated services.
- **Job Postings, Blogs, News Articles, Social Media**: Useful for gathering additional information.
- **SSL/TLS Certificates**: Can provide valuable technical details.

### Popular OSINT Tools

1. **Metagoofil**
   - **Purpose**: Searches metadata from public documents on a target’s website.
   - **Capabilities**: Extracts metadata from various file types like Word, Excel, and PDFs.
   - **Command Example**: `metagoofil -d apple.com -t doc,pdf -l 200 -n 50 -o applefiles -f results.txt`

2. **FOCA**
   - **Purpose**: Finds metadata and hidden information in documents.
   - **Capabilities**: Extracts details like GPS locations and email addresses.
   - **Platform**: Windows only; includes a graphical user interface.

3. **The Harvester**
   - **Purpose**: Gathers emails, subdomains, hosts, and other server-related data.
   - **Capabilities**: Uses search engines and social media for data collection.
   - **Command Example**: `theharvester -d udemy.com -l 250 -b google`

4. **Recon-ng**
   - **Purpose**: Web reconnaissance framework with various modules.
   - **Capabilities**: Conducts WHOIS queries, PGP key searches, and more.
   - **Platform**: Cross-platform; comes pre-installed in Kali Linux.

5. **Shodan**
   - **Purpose**: Searches for IoT devices and other internet-connected hardware.
   - **Capabilities**: Identifies devices with default passwords and unsecured webcams.
   - **Function**: Acts as a search engine for internet-connected devices.

6. **Censys**
   - **Purpose**: Searches for hosts and network configurations.
   - **Capabilities**: Offers a search interface, report generation, and SQL engine integration.
   - **Function**: Helps network defenders discover unknown assets and manage cloud sprawl.

7. **Maltego**
   - **Purpose**: Visualizes relationships between pieces of information.
   - **Capabilities**: Maps out connections between emails, social media profiles, and more.
   - **Function**: Automates querying of public data and provides graphical representations of relationships.

### Using OSINT Tools

- **Objective**: Gather information without directly connecting to the target’s servers.
- **Strategy**: Use tools to search publicly available data and analyze results for actionable intelligence.

#

# Using OSINT Tools (OBJ 2.1)

## Open-Source Intelligence Tools Overview

In this lesson, we'll explore three open-source intelligence tools: **Metagoofil**, **theHarvester**, and **Recon-NG**.

### Metagoofil

**Purpose:** Extracts metadata from documents on a website.

**Steps:**

1. **Installation:** 
   - If not installed, run: `sudo apt-get install Metagoofil`.
   - If it's not installed, it will prompt to install it.

2. **Usage Example:**
   - To search for Word, PowerPoint, and PDF files on `udemy.com`:
     ```bash
     Metagoofil -d udemy.com -t doc,docx,ppt,pptx,pdf -l 50 -n 25 -o Udemy_files -f results.html
     ```
   - **Parameters:**
     - `-d`: Domain to search.
     - `-t`: File types.
     - `-l`: Limit number of documents.
     - `-n`: Number of files to download.
     - `-o`: Output directory.
     - `-f`: Output file format.

3. **Issues:**
   - Google might block requests if too many are made.
   - Using Tor can help avoid this issue.

### theHarvester

**Purpose:** Gathers information such as emails, subdomains, and open ports.

**Steps:**

1. **Usage Example:**
   - To search for information on `udemy.com` using Google:
     ```bash
     theHarvester -d udemy.com -l 5 -b google
     ```
   - **Parameters:**
     - `-d`: Domain.
     - `-l`: Limit number of results.
     - `-b`: Search engine to use.

2. **Issues:**
   - Google may block requests if it detects bot activity.
   - Consider using Tor to circumvent blocking.

### Recon-NG

**Purpose:** A comprehensive web reconnaissance framework.

**Steps:**

1. **Startup:**
   - Run: `Recon-NG`.

2. **Workspace Management:**
   - Create a new workspace:
     ```bash
     workspaces create Dion
     ```
   - List workspaces:
     ```bash
     workspaces list
     ```
   - Switch workspaces:
     ```bash
     workspaces load Dion
     ```

3. **Module Management:**
   - Install a module (e.g., `whois_pocs`):
     ```bash
     marketplace install recon/domains-contacts/whois_pocs
     ```
   - Load a module:
     ```bash
     modules load recon/domains-contacts/whois_pocs
     ```

4. **Database Management:**
   - Insert domains into the database:
     ```bash
     DB insert domains diontraining.com
     DB insert domains udemy.com
     DB insert domains tesla.com
     ```
   - View database schema:
     ```bash
     DB schema
     ```
   - Show database contents:
     ```bash
     show domains
     ```

5. **Using the Module:**
   - After loading a module, configure and run it to gather data from the whois database.

**Notes:**
- Ensure you're using the correct syntax for the Recon-NG version you're working with.
- For detailed instructions, consult the Recon-NG manual or online resources.

#

# DNS Information (OBJ 2.1)

## DNS Record Types and Their Uses

The Domain Name System (DNS) allows access to network clients using human-readable hostnames instead of numeric IP addresses. Here’s a summary of key DNS record types and their purposes:

## A Record
- **Purpose:** Links a hostname to an IPv4 address.
- **Example:** `diontraining.com` resolves to an IP address.

## AAAA Record
- **Purpose:** Links a hostname to an IPv6 address.
- **Example:** `diontraining.com` could resolve to an IPv6 address.

## CNAME Record
- **Purpose:** Points a domain name to another domain name or subdomain, rather than an IP address.
- **Example:** `itil4exam.com` redirects to `diontraining.com`.

## MX Record
- **Purpose:** Directs email to a mail server and indicates how email messages should be routed using SMTP.
- **Example:** `diontraining.com` mail records point to Google’s mail servers.

## SOA Record
- **Purpose:** Stores important information about a domain name or zone, including authoritative server details.
- **Example:** Indicates the responsible server for `diontraining.com`.

## PTR Record
- **Purpose:** Correlates an IP address with a domain name, the reverse of an A record.
- **Format:** `.arpa`
- **Example:** Resolves an IP address back to a hostname.

## TXT Record
- **Purpose:** Allows domain administrators to add machine-readable text to the DNS.
- **Example:** Verifies domain ownership or allows services to send emails on behalf of the domain.

## SRV Record
- **Purpose:** Specifies a host and port for a specific service.
- **Example:** Designates a port for a chat server or VoIP service.

## NS Record
- **Purpose:** Indicates which DNS name server is authoritative for the domain.
- **Example:** Changing from GoDaddy to Google Domains requires updating NS records.

## Using DNS Records in Penetration Testing
- **Reconnaissance Phase:** Gather DNS records to identify servers, services, and third-party tools.
- **Focus Areas:** MX records for email services, TXT and SRV records for third-party services.

## Tools for Querying DNS Records
- **Common Tools:** `nslookup`, `dig`, `host`
- **Purpose:** Query domain name servers for various record types.

## Whois Information
- **Purpose:** Provides details about domain ownership, including registrant information and domain status.
- **Tools:** `whois` command line tool or online services.
- **Considerations:** Whois information may be protected by privacy services but can still provide useful data for reconnaissance.

Use these DNS record types and tools effectively to gather information and identify potential targets during your security assessments.

#

# Reconnaissance with CentralOps (OBJ 2.1)

## Using CentralOps.net for Reconnaissance

CentralOps.net is a valuable resource for hackers, providing tools for gathering publicly available information about domains and email addresses. This helps in understanding a victim's network and planning attacks. Here's how to use CentralOps.net effectively:

### Steps for Domain Dossier

1. **Access CentralOps.net**
   - Open Firefox on your Cali machine and go to [CentralOps.net](http://centralops.net).

2. **Select Domain Dossier**
   - Choose the `Domain Dossier` option.

3. **Enter Domain or IP**
   - For example, use `AVG` (an antivirus company based in the Netherlands).

4. **Choose Options**
   - Select all five options: Traceroute, Service Scan, DNS Records, Whois Network, and Whois Domain.

5. **Analyze Results**
   - **Address Lookup:** Provides IP addresses associated with the domain.
   - **Domain Whois Record:** Shows registration details. Large companies often use domain administrators for privacy.
   - **Detailed Whois Record:** Displays more granular information like addresses, phone numbers, and email addresses.
   - **Name Servers:** Indicates the use of Akamai (akam.net), which can prevent denial-of-service attacks.
   - **Network Whois:** Lists IP address ranges owned by the company.
   - **DNS Records:** Shows DNS records including IP addresses and name servers.
   - **Traceroute:** Reveals network paths and security measures like firewalls.
   - **Service Scan:** Identifies open ports and services.

### Example with a Small Business

1. **Repeat Steps for Another Domain**
   - Use `TitanCipher.com` (a domain owned by the user and hosted on Bluehost).

2. **Analyze Results**
   - **Address Lookup:** Single IP address associated with TitanCipher.
   - **Domain Records:** Shows that Bluehost hosts the domain.
   - **Network Whois:** Provides ownership details of the IP block.
   - **DNS Records:** Indicates name servers and mail servers.
   - **Traceroute:** Displays network path with visible IP addresses.
   - **Service Scan:** Identifies open ports and services like FTP and web servers.

### Email Dossier

1. **Check Email Validity**
   - Test email addresses to see if they are valid or rejected by the server.
   - Useful for spear phishing campaigns and avoiding spam filters.

### Summary

CentralOps.net is a versatile tool for gathering essential information during reconnaissance. It helps in understanding network infrastructure, identifying potential targets, and planning attacks. Experiment with various tools to find what suits your style and needs for effective reconnaissance.

#

# Public Repositories (OBJ 2.1)

## Reconnaissance Techniques: Public Repositories, Website Archives, and Image Searches

### Public Source Code Repositories

- **Overview**: Public source code repositories allow developers to collaborate on software projects. These repositories can be either public or private, but sometimes private files become accidentally public.
- **Popular Repositories**: GitHub, Bitbucket, SourceForge.
- **Information Available**:
  - **Source Code**: Analyze for vulnerabilities and insecure coding practices.
  - **Discussion Forums and Issue Tracking**: Provides additional context about the software and potential vulnerabilities.
  - **API Keys, Usernames, Passwords**: Sometimes exposed in public repositories, which can be used for further exploitation.
- **Usage**: Repositories are used for version control and to facilitate collaboration in software development. Publicly available code can be a valuable source for finding vulnerabilities.

### Website Archives and Caches

- **Overview**: Website archives and caches can provide historical snapshots of websites.
- **Tools**:
  - **Wayback Machine (archive.org)**: View past versions of a website.
  - **Google Cache**: Use the keyword `cache:` followed by the website name to access cached versions.
- **Use Cases**:
  - **Find Deleted Information**: Access files or disclosures that were removed from the website.
  - **Historical Data**: Discover confidential information that might have been exposed in the past.

### Image Searches

- **Overview**: Search for images not just by keywords, but also by uploading images to find their sources.
- **Tools**:
  - **Google Images**: Upload a picture to perform a reverse image search.
- **Use Cases**:
  - **Identify People**: Find images of individuals across the web, such as LinkedIn profiles or personal websites.
  - **Track Image Usage**: Discover where an image has been used online, which can help in gathering more information about a target.

### Summary

Reconnaissance can be significantly enhanced by exploring public source code repositories for sensitive information, examining website archives for historical data, and using image searches to track down additional online presence. These techniques provide valuable insights that can aid in penetration testing and further investigative efforts.

#

# Search Engine Analysis (OBJ 2.1)

## Search Engine Analysis and Google Hacking

### Overview

- **Definition**: Google hacking is a technique of open-source intelligence that uses Google search operators to locate vulnerable web servers and applications. It does not involve hacking Google’s servers but rather using advanced search techniques to find specific information.

### Key Search Operators

1. **Quotes ("")**: 
   - **Purpose**: Search for an exact phrase.
   - **Example**: `"Jason Dion"` finds pages where "Jason Dion" appears together.

2. **NOT Operator (-)**:
   - **Purpose**: Exclude specific terms from search results.
   - **Example**: `PenTest+ -Dion Training` finds results for PenTest+ excluding those from Dion Training.

3. **AND/OR Operators**:
   - **AND**: Requires both search terms.
     - **Example**: `Jason AND Dion` finds pages with both "Jason" and "Dion" (not necessarily together).
   - **OR**: Requires either search term.
     - **Example**: `Jason OR Dion` finds pages with either "Jason" or "Dion".

4. **Scope Modifiers**:
   - **Purpose**: Define the search scope.
   - **Examples**:
     - `filetype:PDF` searches for PDF files.
     - `site:example.com` searches within a specific site.
     - `allintitle:term` searches for pages with all terms in the title.

5. **URL Modifiers**:
   - **Purpose**: Modify search result settings.
   - **Examples**:
     - `&pws=0` (disable personalized search results).
     - `&filter=0` (disable result filtering).
     - `&tbs=li:1` (disable autocorrect for search terms).

### Google Hacking Database (GHDB)

- **Purpose**: Provides a collection of optimized search strings for locating vulnerable websites and services.
- **Examples**:
  - `intitle:webview login alcatel lucent` (finds login pages for Alcatel-Lucent devices).
  - `intitle:index of wp-security-audit-log` (finds exposed security audit logs).

### Example Search

- **Search String**: `filetype:xls password site:diontraining.com`
  - **Purpose**: Search for Excel files containing "password" on the site `diontraining.com`.

#

# URL Analysis (OBJ 2.1)

## Introduction
A URL (Uniform Resource Locator) is an address used to access resources on the web. For a cybersecurity analyst, understanding URL structures and analyzing them is crucial to detect potential threats.

## URL Analysis Objectives
- **Identify Malicious Scripts or Activities**: Check if a URL is flagged and analyze any encoded data.
- **Tools and Techniques**: Use the right tools to decode percent encoding and assess redirections and scripts in a sandbox environment.

## URL Components
1. **HTTP Methods**
   - **GET**: Retrieve a resource.
   - **POST**: Send data to a server for processing.
   - **PUT**: Create or replace a resource.
   - **DELETE**: Remove a resource.
   - **HEAD**: Retrieve headers only, ignore the body.

2. **Query Parameters**
   - Delimited by `?` and formatted as `name=value` pairs, with multiple pairs separated by `&`.
   - Example: `upload.php?post=value`

3. **Fragments**
   - Indicated by `#`, used to navigate to a specific part of a page. Not processed by the server.

## HTTP Response Codes
- **200**: Success (GET or POST)
- **201**: Resource created (PUT)
- **300**: Redirect
- **400**: Client error (e.g., 404: Not Found, 403: Request didn't have sufficient permissions, 401: Unauthorized, 400: Request couldn't be parsed by the server) 
- **500**: Server error (e.g., 500: General error on server side of application, 502: Bad Gateway, 503: Service Unavailable, 504: Gateway timeout; issue with upstream server)

## Percent Encoding

Percent Encoding: Mechanism to encode 8 bit character that have meaning in context of URLs known as URL encoding.
- **Purpose**: Encode unsafe characters and data in a URL.
- **Unreserved Characters**: A-Z, 0-9, '-', '.', '_', '~'.
- **Reserved Characters**: `:`, `/`, `?`, `#`, `@`, `!`, `$`, `&`, `'`, `(`, `)`, `*`, `+`, `,`, `;`, `=`.
- **Unsafe Characters**: Null string termination, carriage returns, line feeds, spaces, `\`, `<`, `>`, `{`, `}`.

### Percent Encoding Example
- `%3C` = `<`
- `%3E` = `>`
- `%27` = `'`
- `%2F` = `/`
- `%2E` = `.`

![image](https://github.com/user-attachments/assets/3d0dd909-2354-49d2-9e73-53e17661f1b9)

- **Encoded URL**: `Diontraining.com/upload.php?post=%3Cscript%3E%27http%3A%2F%2FABC123.com%2Frat%2Ejs`
- `<Script>` = Javascript


## URL Analysis for Security
- **Identify Encoding**: Look for encoded characters that may conceal malicious scripts or data.
- **Examine Components**: Analyze query parameters and fragments for potential vulnerabilities.

## Exam Tips
- **Focus on Percent Encoding**: Recognize when percent encoding is used and its implications for URL analysis.
- **Practical Application**: Understand common encodings and their meanings; apply this knowledge to identify possible threats or injections.

#

# Cryptographic Flaws (OBJ 2.1)

