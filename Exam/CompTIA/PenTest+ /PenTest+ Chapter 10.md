# CompTIA® PenTest+® Certification For Dummies®, 2nd Edition

# Chapter 10: Analyzing Script Functionality

Script Environments that we will see in PenTest+
- Bash Scripting
- Pythin Scripting
- Ruby Scripting
- PowerShell (PS) Scripting

#

## Reviewing  Scripting Concepts

### Variable and Arrays

#### Variable

Variable:
- Named area of memory that used to store info temporarily, you can manipulate and retrieve that info at later time.
- Example: store purchase date of a product in a variable then calculate payment date off of that variable.

![image](https://github.com/user-attachments/assets/7a282f07-e0b7-4dbd-9eb3-7bd60273cbdb)

- Executed `get-date` cmdlet and then store the result into a variable called `$purchaseDate`.
- Add 30 days to purchase date and place that new date into a variable called `$paymentDate`.
- Then print out the `$paymentDate` to see when payment is due.

Explaination:
- We have two variable called `$purchaseDate` and `$paymentDate`.
- Variable reference blocks of memory in computer by using a friendly name ($purchaseDate or $paymentDate).
- Purpose of friendly variable name is so we don't need to know the hexadecimal memory address reference different blocks of memory: 0x0000-0x03FF)


#### Array

Array:
- Variable that allowed to store multiple elements.
- Each element is given an index number within array.

![image](https://github.com/user-attachments/assets/fd20a7d1-b782-4104-8c00-6119c87c8fcf)

Explaination:
- Created an array called `$names` (looks like variable)
- Storing multiple values: Bob, Tom and Sue.
- Each item sored in array is assigned an index number starting with 0.
  - Bob = index number of 1, Tom = index number of 1, Sue = index number of 2.
- To work with one of the element within the array, you must reference the inces number after the array name.
- `$names[1]` will print the word "Tom".

#

### Looping and Flow Control

Second most elements in programming language are if statements and loop structures.
- `If statements` known as condition structures: Used to perform test within your program logic.
- `looping structures`: Used to repeat execution of code a number of times.


#### If statements

If Statements:
- Used to perform test within your program logic.

Example:
- In purchase and payment date example, if you want to check whether a payment date is more than 30 days after purchase date.
- It it is, then you want a message to display that let's the purchaser know payment is late (the purchaser would have to pay a late fee).

![image](https://github.com/user-attachments/assets/e30bdc89-4ad5-41d2-bf31-c602ddc780de)

If Statement Example:

![image](https://github.com/user-attachments/assets/81dbecbc-944c-4670-be90-9eb3e9892730)

- Test is determining whether `$numDayToPay` is greater than 30.
- If it is, block of code will run (Payment overdue. Pay $30.00 late fee.)
- Block of cod is inside curly brackets. {}

If else Statement Example:

![image](https://github.com/user-attachments/assets/f35bdb82-e4a7-4a8c-a5f2-cb3b3f205a77)

- If ...else statement allow specify what happens if test is found true or false.
- If the payment date is greater than 30 days: message is displayed.
- Otherwise, if payment date is not over 30 days display: "Payment on time. Thank you".


#### Loops

Loops:
- Execute same code multiple times.

Example:
- If you want to do banner grab on multiple ports
- You would only need towirte code to connect to a port once,
- Then place the code into loop, each time with different port number.

Loops Example:

![image](https://github.com/user-attachments/assets/732c7eb6-bb18-4eba-a94f-4452dc68bcdf)

- First line of code: variable called `$i` is assigned number 1.
- Second line: keyword `Do` starts a loop, defined by contents of set of curly brackets {}
- Note: code within bracket (the Do Loop) prints the value of variable $i.
- Then increment $i by one: with `$i++`.
- While at the end of the loop specifies how many times the loop repeats based on condition.
  - Code is executed again whie $i is less than 10.
  - After the first time the loop runs, $i is 2, so loop runs again.
 
#

### Comparisons

Comparison:

If statement and loop structures typically contain tests that need to be performed in order to determine whether code in If Statement is run and whether code in loop is run.

Example:
- Test may be to see if $i is greater than 5.
- Syntax to perform this comparison test is different for each language.
- PowerShell, syntax is `$i -gt 5`.
- Python, syntax is `$i > 5`.
- `-gt` and `>` = comparison operators.

Comparison Operator:
- Always evaluate to true value or false value.
- Then Used to control the flow of logic in app with loop or conditional structure such as "if statement".

![image](https://github.com/user-attachments/assets/72c1d834-8769-4199-9b7d-c68866069a37)

#

### Understanding Operators

Types of Operators:
- Conditional Operators
- Boolean Operators
- String Operators
- Arithmetic Operators


#### Conditional Operators

Conditional Operators:
- Operator that executes code base on the result of an expression.

Example: 
- Ternary operator of `?`: is used to perform a test condition.
- If test is found successful, value is returned.
- Otherwise alternative value is returned.

Basic syntax for conditional operator:
- `Condition ? ValueIfTrue : ValueIf False`
- `string weather = temp < 20 ? "Cold Weather" : "Warm Weather";`


#### Boolean Operators

Boolean Operators:
- Operator such as AND or OR that is used to create Boolean expressions that return a result of "True" or "False",
- Based on whether both conditions are true (AND) or either condition return true OR).


### String Operators

String Operators:
- Operator that works with strings (text values).

Example: 
- In many languages `a +` or `a &` is used to join text values together.


#### Arithmetic Operators

Arithmetic Operators:
- Operator that perform mathematic operation.

Example:
- `+, -, *, /`


#

### Data Structures

Data Structures:
- Represent how data is stored in memory or in file.

Example: 
- Can store data in file so your script can read data later in common file format such as command-separateed values (CSV) file or JavaScript Object Notation (JSON) file.

Types of common format for data that is accessed by a script:

![image](https://github.com/user-attachments/assets/7f1f3f6c-beda-44dc-a172-968d7058492a)

#

### Parts of Software and Scripts

When writing app or script, software or script can use number of components.

Types of common elements that could used:
- Procedures
- Functions
- Classes
- Libraries


#### Procedures

Procedures:
- A block of code that is given a name
- So it can be executed by calling the name.
- Used to group common code blocks together so that they can be called over and over again without needing to rewrite the same code.


#### Functions

Functions:
- Similar to procedure
- A block of code that is given a name, but it returns a value after being called.


#### Classes

Classes:
- Blueprint for type of object you want your code to work with.

Example: 
- Create a class that represents customer that has properties such as lastname and firstname.
- Any time you need a customer object in your code, you simply create the object by creating an instance of the class.


#### Libraries

Libraries:
- File contains function, procedure, or classe that enable multiple application or scripts to use those items.

Example:
- Create a Dynamic Link Library (DLL) file that contains all of your shared logic.

#

### Common Operations

Types of Common operations:
- Encoding/decoding
- Input/Output
- Substitutions
- String Operation


#### Encoding/Decoding

Encoding/Decoding:

![image](https://github.com/user-attachments/assets/fb35b4ef-3939-4dec-9f10-55b5ce445ba4)


#### Input and Output

Input/Output:

![image](https://github.com/user-attachments/assets/95e7db01-a250-4524-bd6e-07ba9303c8fa)


#### String Operations

String Operation:

![image](https://github.com/user-attachments/assets/62bc6a4b-3090-4d14-9fc9-8e8fac3e52f3)


#### Substitutions

Substitutions:

![image](https://github.com/user-attachments/assets/bace0bb3-4bc4-4039-9cdd-455891ec588b)


#

### Error Handling

Error Handling:
- Useful for scenarios where you expect errors and want to execute specific logic in those cases
- Also useful to handle unexpected error, allows you to exit program gracefuly with friendly error message insetead of code crashing. (What happens if you don't handle error).

- Most language support `try ...catch` blocks
  - A way to implement error handling.
  - All code you want to execute goes into a `try` block;
  - `catch` block contain code you wish to execute if an error occurs.

![image](https://github.com/user-attachments/assets/0603af1d-3164-4912-aa82-f2d295b26009)

- First place all of the code we want to execute in `try` block.
  - Mean if any code fail, program jumps to catch block.
- Inside try block, create an object variable called `$wc`that used to send an HTTP request for a file.
- Next command is used to actually download the file and where to download it on local computer.

Try. . .catch block are not supported by all programming language but supported by most.


#

## Using Bash Script

In Linux you can create script to automate admin of Linux system.
- Script in Linux = Bash Shell Script or Shell script.
- Shell script files can be created with any text editor in linux: vi editor, nano
  - Saved with .sh extension.
- can place linux commands to perform linux task:
- `#!/bin/bash`: specifies the interperter of the script.


### Variables and Arrays

#### Variables

Working with variables:
- variable = temporary storage space for info that you will use later in script.
- Create variable in shell script:

![image](https://github.com/user-attachments/assets/ced53f73-f02e-4975-8000-9d2f37fb2412)

 - First line: stores a string in variable called strName
 - Second line: uses echo command to print the variable contents onto the screen.
 - Note: line that creates variable does not have # in the variable name, but when you refer to it, it does.

Example:
- If you want to prompt user for info and store what user types as response into a variable:

![image](https://github.com/user-attachments/assets/5397b205-f806-4cd6-8d49-4ea889b56147)

- Read command is used to read input and place that input into variable called CITY.
- Anytime you want to use variable within your script you place a dollar sign ($) in front of the variable name "$CITY".


#### Arrays

Using Arrays:
- If you want to store multople piece of info in array on Bash Shell Script:

![image](https://github.com/user-attachments/assets/837de9c6-4317-4a68-b283-4ed14e15c638)

- This code is similar to creating a variable with exception of parentheses containing multiple values separated by spaces.
- Array called "names" has three elements: names[0], names[2], names[2] is creted.

- To print out one of the elements in array, must reference the array using $ and curly brackets ({}):

![image](https://github.com/user-attachments/assets/2138bf60-2a1a-4faa-8c8c-c89317030e32)

- This will print the second element of the array, "Bob".
- If you want to print all the values of array: use `@` or `*` instead of an index number:

![image](https://github.com/user-attachments/assets/9e446027-2b13-4df0-90b8-13fa12427a0e)


#### Looping aned Flow Control

Flow control = using such code as if statement
Looping structure = how we execute same code multiple times.


If Statements:
- Decision Structure

![image](https://github.com/user-attachments/assets/83fd4d31-a7e4-4d15-ba1e-30fcae905b44)

- Test performing with If Statement appears withihn `[]` square brackets.
- Follows by semicolon `;`, `then` on the same line as `if`.
- Inside If statement, specify commands to execute if condition is found true.
- End the if statement use `fi`.

If Else Statement:
- Condition found false by adding else

![image](https://github.com/user-attachments/assets/ad437a2c-40d4-4263-a18d-20a8b5324316)

Elseif Statement:
- if statment checks to see if $AMOUNT is greater than 100
- then want to check if it is less than 10.
- If statement block structure can have many elseif statement or none.
- To perform multi tests, with an elseif statement in shell script:

![image](https://github.com/user-attachments/assets/3b63864c-e6f1-416b-8406-0b902494c2f8)


#### For Loop

For Loop:
- Used to loop thru a set of values.

![image](https://github.com/user-attachments/assets/1671578a-1311-44c4-8d1e-451118af14d5)

- Loops thru number 1, 2, 3, 4 where $i will hold one of thhose value each time thru the loop then print the value.


#### While Loop

While Loop:
- Used to execute block of code while the condition is found true.

![image](https://github.com/user-attachments/assets/ce01a0be-f7e9-4350-bc74-8ee5eb2c0c28)

- Prompts for xity and continues to prompt the user for city until the city is equal to "Halifax".
- Note: inclusion of `do` at the beginning of the code that is to execute, and `done` at the end of the code to identify the end of the loop.


#### Executing the Script

Executing the Script:
- Once typed command into script file, saved file withh .sh extension.
- To execute the script, need to ensure that you have the execute permission on the file.
- To give execute permission on file you use `chmod` command; change mode:
  - `$ chmod 755 script1.sh`
- Once have permission to execute script, you can execute it by referencing script file by its name, including path of the file:
  - `$ ./script1.sh`
 

#### Error handling

Error Handling:
- Does not support `try. . .catch` blocks to capture errors or execeptions.
- Will need to write your own error handling routines using conditional structures like If Statements to test for common problems that can occur when executing the code.


#### Input and Output

Input and Output:
- Input/Output in programming = reading and writing info to the screen, file, or network.
- To write to screen in Bash, use `echo` statement, read from screen:

![image](https://github.com/user-attachments/assets/f055055e-9d5b-4fcb-91e4-3b071b6461ec)

- Notice: Prompt printed onscreen asks what city you are from,
- then read command follow with variable called CITY.
  - Mean: input will read into $CITY variable, which you can access later.
- Last line of code print $CITY variable on screen.


To read/write to file, use redirection symbols:

![image](https://github.com/user-attachments/assets/7cf39575-6ddd-4197-8976-f62a5c3cc5bf)


Example:

![image](https://github.com/user-attachments/assets/1f9d9f56-77d6-45c0-a7e0-da283d0e7185)

- First line: taking contents of `customer.txt` file and reading that into a variable called `fileContents`.
- Second line: printing with `echo`, name into a file called `customer.txt`.
- Key point: `>>` is being used, which means the name is appended to the bottom of the files after any other content that already exist in the file.
- If `>` was used, it will overwrite the file, deleting all content, then add the name to the file.

#

## Understanding Python Scripting

Python script files are created in text editor
- Saved with `.py` extension
- Need Python interpreter instealled to execute Python scripts.


### Variables and Arrays

#### Variables

Working with Variables 
- Do not declare the variable with data type like other langauges.
- Declare variable known as defining variable.
  - Specify type of data that is stored in variable, tells pc how much memory to reserve.
- Python determines data type based on data that is assigned to variable.
  - Example: when a value has single quotes around it, Python treat that as string value and not integer, float or Boolean.
 
Creating variables:
- String data type:
  - `name = 'Glen Clarke'`
- Integer (numeric) data type:
  - `age = 10`
- Boolean (true or false) date type:
  - `married=false`
 
- Print value of a variable with print statement and the name of variable without $ sign in front of it:
  - `print(name)`


#### Arrays

Using Arrays:
- Specify array name followed by = sign, then square brackets
- specify value to insert into the array as comma separated values:
  - `names=["Bob, "Sue", "Jeff"]`
- To access one of the element within array, you can use index number of the element.
- Print "Sue": `print (name[1])`

#

### Looping and Flow Control

#### If Statements

If Statements:
- Start with keyword: `if`, then specify condition followed by a colon `:`
- Then write all of code that is execute if that condition is found true:

![image](https://github.com/user-attachments/assets/74241921-f2a3-41ca-bfa2-e58870700739)

If...else Statement:
- Add `else` block with `else:` statement
- Code that is execute if condition is found false.

![image](https://github.com/user-attachments/assets/2903e795-fa60-4458-bc9c-d50be4c03ac5)

If...elif (elseif) Statement:

![image](https://github.com/user-attachments/assets/e3f8dc21-7c98-4a0d-858b-82cd012e4580)


#### For Loop

For Loop:
- Python have: `for loop` and `while loo`p.
- For loop used to loop thru known set of values/

Example: 
- Storing number of names into variable and then loop thru names to print them out:

![image](https://github.com/user-attachments/assets/5eb6ea17-ddf1-494a-80a9-604650cbdf3c)

- variable `iter` represent each individual name as it loops thru all names.

![image](https://github.com/user-attachments/assets/c1c39826-4a70-4172-9573-6050843b0a2b)


#### While Loop

While Loop:
- Loop based on condition.

Example:
- User is continuously prompted for a score until user types "0" as score.

![image](https://github.com/user-attachments/assets/d81d82f2-110d-440f-afc8-1310ba1aec5e)

- Note: Indentation is important with Python and loops. Not indenting within loop would cause code to exit out the loop.

#

### Executing the Script

Executing Script:
- Navigate to command prompt and call the python.exe program
- Then pass in as a parameter the path to your script:

![image](https://github.com/user-attachments/assets/2809f451-be8c-4918-a92d-d5e41614dc61)


#

### Error Handling

Error Handling:
- Python supports try...catch blocks
- But called: `try...except` blocks

How it work:
- Place code you wish to execute in `try` block.
- Code you wish to execute if an error, or exception occurs goes into `except` block.

![image](https://github.com/user-attachments/assets/07012448-6c4e-4056-9506-f148bb2462a0)

- Note: Has two except blocks.
- First except block executes if there is very specific (or error) - a division by zero error.
- Other except block does not specify exception, it catches any other type of exceptions.


#

### Input/Output

Input/Output in Python:
- Use `input` function to read what user type into variable.
- If you want to output to screen: use `print` function:

![image](https://github.com/user-attachments/assets/8e2a70f3-558b-4f32-99f6-5daeecc80f7d)

- If you want to read and write to file in python use `open()` function to open the file.
- Then either call `write()` method to write info into file or `read()` method to read contents of the file into Python.

Example of open file and write: 
- Code to open file and write name, city, and country to file.
- Note: Could open the file in append mode with `a` or `create/` overwrite the file by setting the mode to `w`.
- Can also put the file in read only mode by using mode of `r`.

![image](https://github.com/user-attachments/assets/89904157-c1fb-46e0-ae34-6dfd4542c252)

Print contents of file from Python Script:
- Use `read()` method of file variable and pass that to `print` function

![image](https://github.com/user-attachments/assets/3e96608b-b1d2-4fc2-b845-cdbcc59f8bc1)


#

## Working with Ruby Script

Ruby Script Files
- `.rb` externsion.
- Must start with reference to Ruby interpreter
- Then follow it with:

![image](https://github.com/user-attachments/assets/1d154784-23b0-4d85-87cd-2dcbad6b5f77)

- `puts` command is used to print info on screen.
- Assume saved as `firstrubscript.rb`
  - Run: `ruby firstrubyscript.rb`
 
### Variables and Arrays

#### Variables

Working with Variables in Ruby:
- Ruby has many types of variables.
- Local variable will be created most often withhin script code.
- Local variable names must start with an underscore `_` or lowercase character.

Example:

![image](https://github.com/user-attachments/assets/6a785d83-bd0c-47a8-9c31-6f7251fad760)

Type of variables in Ruby:
- Class
- Global
- Instance
- Local

Class: 
- Class variables are shared adata across all instances of the class and can be identified with `@@` at the beginning of the variable name.

Global: 
- Global variables can be accessed anywhere in script.
- Global variables are identified by the name of the variable starting with `$`.


Instance:
- Instance variables are used when creating propertiews of a class.
- Identified with `@` at beginning of the variable name.

Local:
- Local variable are available in current block, def, do or class
- Identified with an `_` or lowercase charactewr at the beginning.


#### Arrays

Using Arrays:
- Common method created in Ruby = create an array of names and then print the second one:

![image](https://github.com/user-attachments/assets/6c5339fa-f0d5-4e32-8215-0efafd3d13e1)

- If you want to print third element from array: reference the element by its index number:

![image](https://github.com/user-attachments/assets/66b2e722-b57b-46e5-971c-af09bba4a35e)

#

### Looping and Flow Control

#### If Statements

If Statements:
- Starts with `if` keyword
- But cawn also have one or more elsif blocks
- Can have an else block as well.
- Completed with `end` keyword

Example:
- Store a number into local variable called `age` then check to see if person is an adult, teen or child depending on the value of age.

![image](https://github.com/user-attachments/assets/576bf9ae-0cbd-40d8-a944-59e594525d7f)


#### Do Loops

Do Loops
- Few types of loops in Ruby.
- First type = do while loop
  - allows you to execute code in loop while condition is true.
 
Example of Do Loops

![image](https://github.com/user-attachments/assets/30e806de-282c-482c-bbd6-7a803f4bb6d3)

- Note: condition for how long you stay in loop is done at the beginning of the loop.
- Means: it is possible to not enter the loop. Which wwe manipulate by placing the `$i=0` statement before loops
- important because another version of a do loop is having to test be performed at the end of the loop.

![image](https://github.com/user-attachments/assets/155e5847-b040-4aa6-873d-0fb44a3e704a)

- This ensures that you enter the loop at lease once.


#### For Loop

For loops:
- Ruby also has for loop that you can use to loop thru a group of elements.
- Code listing have number from 0 to 10 (0..10)
- we loop thru them with the for loop.
- "i" will be 0 at the first time thru the loop. Which gets printed in a sentence.


![image](https://github.com/user-attachments/assets/1ebac4ef-9e89-4476-afae-ef5c71c0b912)


#

### Executing the Script

Executing the Script:
- Save the script with `.rb` extension.
- saved at `firstrubysscript.rb`
- To execute the script we have to run:

- `ruby firstrubyscript.rb`


#

### Error Handling

Error Handling:
- Different in Ruby
- same idea as `try...except` block
- Ruby known as rescue blocks.

Example of Rescue Blocks:
- Can see that it stawrts with a begin block, includes the code we wish to execute.
- If that code cause an exeception (error), then code jump to rescue block, where you can place code you want to execute if there is an exeception.

![image](https://github.com/user-attachments/assets/c79e2dd9-15eb-4594-a2c8-2b9056b58567)


#

### Input/Ouput

Input/Output:
- Can read and write to the screen in Ruby by using `puts` and `get` functions.

Example:
- Code ask for user's name and then prints that name with welcome message by joining the text together with concatenation symbol `+`.

![image](https://github.com/user-attachments/assets/7e2d3691-e77a-4875-90fd-a7aa8368509f)

- If you want to read and write to a file, you cawn use `File.new` method to create a referenfce to file for reading and writing.

![image](https://github.com/user-attachments/assets/b4340135-ca3c-474d-9b2c-4d85322ff11f)

- File.new() is used to open file called customer.txt in read only mode.
- File reference is stored in variable call myFile.
- Then want to read 20 characters out of the file: `myFile.sysred(20)` and store the 20 character into variable.wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww

![image](https://github.com/user-attachments/assets/c7e69ec7-99d5-4d7a-adf2-59c2bb418407)

- If you want to write to the file
- First you have to open file in write mode `r+`.
- Then would use `syswrite()` method instead of `sysread()` method to write info to file.


#

## Coding in PowerShell Scripting

PowerShell = Microsoft's scripting enviornment for Windows
- Easy to identify because it typically inclues cmdlets in code whose syntax appears in ver-noun format.
- Example: Write a message on screen in PowerShell, you can use `write-host` cmdlets.

### Variables and Arrays

#### Variables

Working with variables in PowerShells:
- To create variable, you precede name of the variable with a `$`:
  - `$name = "Glen E. Clarke"`
 
- To print the contents of variable on screen: Use `write-host`:
  - `Write-host $name`
 
- Can store result of cmdlet into a variable.
- Example: `get-date` cmdlet retrieves current date and time. Could store this in a variable
  - `$name = get-date`
 
- To view date on screen, print $now or you could extract a specific feature from $now such as hour or day of the week:

![image](https://github.com/user-attachments/assets/7924c554-d4fb-4aea-912c-e53f1bc8f5af)
 

#### Arrays

Using Arrays in PowerShell:
- Can store multiple items into array then retrieve item by their index number when you need them.

Example:
- Stores three names into array.
- Print the entire array by using array name
- Print the second item "Bob" by using an idex number of 1 in array name.

![image](https://github.com/user-attachments/assets/f6a214b6-ddb5-413a-bd37-e12aaad37f9c)

Storing:
- Can store result of a cmdlet into an array
- Example: create array `$services` that will store list of running services on system
  - `$services = get-service | where {$_.status -eq "Running"}`
- Can use `write-host $services` to print out list of running services.
- or can use `write-host $services[2]` to print the third services in the list.

#

### Looping and Flow Control

If you want to stop all services that start with name "sp":
- `Get-service -name sp* | stop-service`

Using pipeline `|` feature enables you to send result of one command to the next command.
- Other language will need to write loop to do that.
- PowerShell can use loops for multiple tasks on a object like "if statement".


#### If statements

If Statements in PowerShell:
- Start with `if` keyword.
- place your conditional text into parentheses then open true block with `{}`
- place code you wish to execute if the condition is true into `{}`
- Can also add an `elseif` with different condition an run a block of code if that condition is met.
- Can add `else` statement for other result

![image](https://github.com/user-attachments/assets/b56222f1-507f-479b-a27b-26bdbb25a29f)

- Can have multiple `elseif` statement with each one providing different test.


#### Do Loops

Do Loops in PowerShell:
- Powershell support `do...while` loops.
- Enable you to execute code multiple times based on a condition.

![image](https://github.com/user-attachments/assets/1a1120a0-50df-4fc5-a26b-bbdddf67bb05)

Example:
- Could prompt for port to scan and unless a number from 1 to 1024 is supplied
- Keep prompting for port number

![image](https://github.com/user-attachments/assets/b23c4837-0892-40e9-8561-3e0effeaca31)

- Note: Had to put [int] in front of $port variable name to force variable to be of the data type integer.


#### For Next Loop

For Next Loop in PowerShell:
- Useful when you know how many times you wish to go thru a loop.
- Basic structure of loop is broken into three parts, with each part separated by semicolon `;`.

![image](https://github.com/user-attachments/assets/a89e6341-edb5-4288-b599-047bf1523a44)

- Start with keyword `for`
- Then in `()` you have initializer: declaring variable to use in the loop.
- Followed by `;` and the conidition: defines how long you want to stay in the loop)
- Incrementer: responsible for adjusting the value of your variable.

Example:
- Creating a variable called `$i`
- Assigning it the value of 1 (initializer section)
- Specify that we stay in the loop while `$i` is less than 255 (condition section)
- Have the incrementer add 1 to `$i` after loop executes with `$i++`.
- Inside loop, used `ping` command.
- Script will ping all IP addresses in 192.168.2.0 class C range

![image](https://github.com/user-attachments/assets/4f0150e4-f831-4047-96f4-56b72a73decb)


#

### Executing the Script

Executing Script in PowerShell:
- After creating script file for PowerShell
- Save the file with `.ps1` extension.
- Go into PowerShell prompt and execute the file by referencing the file with absolute path or relative path.
- Must reference the path to where the file exists.
- Cannot execute script by just its filename.

Example: 
- We have script called first.ps1 stored in c:\scripts folder.
- To run script:
  - ` PS C:\scripts> c:\scripts\first.ps1`
- Because you are in the folder that contains .ps1 file, you wish to execute
- You can reference the current folder with a period `.` then add a `\` and the filename.
  - `PS C:\scripts> .\first.ps1`

#

### Error Handling

Error handling in PowerShell:
- Same as Java or C#
- Implementing `try...catch` blocks.

Example: 

![image](https://github.com/user-attachments/assets/14e6239c-32b3-41dd-b60e-29631a0db6dc)


#

### Input/Output

Input and Output in PowerShell:
- Can read input from keyboard into a variable by using `read-host` command
- Then supplying some text that acts as prompt.

Example:
- You can ask for FQDN of the system to do an nslookup:

 ![image](https://github.com/user-attachments/assets/322f7cd6-22c5-4efb-b722-1e8ee366b1e1)

- Can also display info on screen at any point in time with a `write-host` statement.

Example:
- You want to add your own progres text to screen that states nslookup:

![image](https://github.com/user-attachments/assets/dffc3b71-8408-4a9f-849d-a194d322a55b)

- If you are looking to read the contents of a file, use `get-content` cmdlet.

Example:
- Have a file `system.txt` includes list of IP addresses that I would like to ping.
- With each IP address on its own line.
- Can read that into an array and then loop thru each one to ping them with:

![image](https://github.com/user-attachments/assets/962df2b3-cdac-4a67-bab6-32fccf5f667e)

- Can also write a file with `out-file` cmdlet or use traditional redirect symbol `>` to overwrite file.
- `>>` to apeend to the file.

Example:
- Perform pings but write the output to a file for review:

![image](https://github.com/user-attachments/assets/b75394a9-12cf-46ff-affb-200979864699)

#

## Code Examples and Automation

### Analyze Exploit Code

#### Performing Ping Sweep

Ping Sweep
- Used to identify which system are up and running

Example:
- Python code used to perform ping sweep on network.

![image](https://github.com/user-attachments/assets/6f00c284-c6b0-4550-8a63-ccf793630741)


#

## For The Exam

- Expect to know language used and what script is doing.
- PowerShell and Bash Script use comparison Operators; `-eq` and `-ne` instead of `==` or `!=`.
- Identify Bash shell scripting: always watch for `elif` instead of `elseif`; keyword `fi` finish if statement.
- Bash script uses echo statement to print information on screen.
- Python script use `print` statement instead of `echo` statements to dispaly information on screen.
- Python script Referencing a variable without $ sign in front of variable name
- Local variable for Ruby is typically with `_` underscore.
- PowerShell script will usually contain cmdlets that follow syntax pattern of verb-noun: `get-service` `get-content` `stop-service`.
