# CompTIA® PenTest+® Certification For Dummies®, 2nd Edition

# Chapter 10: Analyzing Script Functionality

Script Environments that we will see in PenTest+
- Bash Scripting
- Pythin Scripting
- Ruby Scripting
- PowerShell (PS) Scripting

#

## Reviewing  Scripting Concepts

### Variable and Arrays

#### Variable

Variable:
- Named area of memory that used to store info temporarily, you can manipulate and retrieve that info at later time.
- Example: store purchase date of a product in a variable then calculate payment date off of that variable.

![image](https://github.com/user-attachments/assets/7a282f07-e0b7-4dbd-9eb3-7bd60273cbdb)

- Executed `get-date` cmdlet and then store the result into a variable called `$purchaseDate`.
- Add 30 days to purchase date and place that new date into a variable called `$paymentDate`.
- Then print out the `$paymentDate` to see when payment is due.

Explaination:
- We have two variable called `$purchaseDate` and `$paymentDate`.
- Variable reference blocks of memory in computer by using a friendly name ($purchaseDate or $paymentDate).
- Purpose of friendly variable name is so we don't need to know the hexadecimal memory address reference different blocks of memory: 0x0000-0x03FF)


#### Array

Array:
- Variable that allowed to store multiple elements.
- Each element is given an index number within array.

![image](https://github.com/user-attachments/assets/fd20a7d1-b782-4104-8c00-6119c87c8fcf)

Explaination:
- Created an array called `$names` (looks like variable)
- Storing multiple values: Bob, Tom and Sue.
- Each item sored in array is assigned an index number starting with 0.
  - Bob = index number of 1, Tom = index number of 1, Sue = index number of 2.
- To work with one of the element within the array, you must reference the inces number after the array name.
- `$names[1]` will print the word "Tom".

#

### Looping and Flow Control

Second most elements in programming language are if statements and loop structures.
- `If statements` known as condition structures: Used to perform test within your program logic.
- `looping structures`: Used to repeat execution of code a number of times.


#### If statements

If Statements:
- Used to perform test within your program logic.

Example:
- In purchase and payment date example, if you want to check whether a payment date is more than 30 days after purchase date.
- It it is, then you want a message to display that let's the purchaser know payment is late (the purchaser would have to pay a late fee).

![image](https://github.com/user-attachments/assets/e30bdc89-4ad5-41d2-bf31-c602ddc780de)

If Statement Example:

![image](https://github.com/user-attachments/assets/81dbecbc-944c-4670-be90-9eb3e9892730)

- Test is determining whether `$numDayToPay` is greater than 30.
- If it is, block of code will run (Payment overdue. Pay $30.00 late fee.)
- Block of cod is inside curly brackets. {}

If else Statement Example:

![image](https://github.com/user-attachments/assets/f35bdb82-e4a7-4a8c-a5f2-cb3b3f205a77)

- If ...else statement allow specify what happens if test is found true or false.
- If the payment date is greater than 30 days: message is displayed.
- Otherwise, if payment date is not over 30 days display: "Payment on time. Thank you".


#### Loops

Loops:
- Execute same code multiple times.

Example:
- If you want to do banner grab on multiple ports
- You would only need towirte code to connect to a port once,
- Then place the code into loop, each time with different port number.

Loops Example:

![image](https://github.com/user-attachments/assets/732c7eb6-bb18-4eba-a94f-4452dc68bcdf)

- First line of code: variable called `$i` is assigned number 1.
- Second line: keyword `Do` starts a loop, defined by contents of set of curly brackets {}
- Note: code within bracket (the Do Loop) prints the value of variable $i.
- Then increment $i by one: with `$i++`.
- While at the end of the loop specifies how many times the loop repeats based on condition.
  - Code is executed again whie $i is less than 10.
  - After the first time the loop runs, $i is 2, so loop runs again.
 
#

### Comparisons

Comparison:

If statement and loop structures typically contain tests that need to be performed in order to determine whether code in If Statement is run and whether code in loop is run.

Example:
- Test may be to see if $i is greater than 5.
- Syntax to perform this comparison test is different for each language.
- PowerShell, syntax is `$i -gt 5`.
- Python, syntax is `$i > 5`.
- `-gt` and `>` = comparison operators.

Comparison Operator:
- Always evaluate to true value or false value.
- Then Used to control the flow of logic in app with loop or conditional structure such as "if statement".

![image](https://github.com/user-attachments/assets/72c1d834-8769-4199-9b7d-c68866069a37)

#

### Understanding Operators

Types of Operators:
- Conditional Operators
- Boolean Operators
- String Operators
- Arithmetic Operators


#### Conditional Operators

Conditional Operators:
- Operator that executes code base on the result of an expression.

Example: 
- Ternary operator of `?`: is used to perform a test condition.
- If test is found successful, value is returned.
- Otherwise alternative value is returned.

Basic syntax for conditional operator:
- `Condition ? ValueIfTrue : ValueIf False`
- `string weather = temp < 20 ? "Cold Weather" : "Warm Weather";`


#### Boolean Operators

Boolean Operators:
- Operator such as AND or OR that is used to create Boolean expressions that return a result of "True" or "False",
- Based on whether both conditions are true (AND) or either condition return true OR).


### String Operators

String Operators:
- Operator that works with strings (text values).

Example: 
- In many languages `a +` or `a &` is used to join text values together.


#### Arithmetic Operators

Arithmetic Operators:
- Operator that perform mathematic operation.

Example:
- `+, -, *, /`


#

### Data Structures

Data Structures:
- Represent how data is stored in memory or in file.

Example: 
- Can store data in file so your script can read data later in common file format such as command-separateed values (CSV) file or JavaScript Object Notation (JSON) file.

Types of common format for data that is accessed by a script:

![image](https://github.com/user-attachments/assets/7f1f3f6c-beda-44dc-a172-968d7058492a)

#

### Parts of Software and Scripts

When writing app or script, software or script can use number of components.

Types of common elements that could used:
- Procedures
- Functions
- Classes
- Libraries


#### Procedures

Procedures:
- A block of code that is given a name
- So it can be executed by calling the name.
- Used to group common code blocks together so that they can be called over and over again without needing to rewrite the same code.


#### Functions

Functions:
- Similar to procedure
- A block of code that is given a name, but it returns a value after being called.


#### Classes

Classes:
- Blueprint for type of object you want your code to work with.

Example: 
- Create a class that represents customer that has properties such as lastname and firstname.
- Any time you need a customer object in your code, you simply create the object by creating an instance of the class.


#### Libraries

Libraries:
- File contains function, procedure, or classe that enable multiple application or scripts to use those items.

Example:
- Create a Dynamic Link Library (DLL) file that contains all of your shared logic.

#

### Common Operations

Types of Common operations:
- Encoding/decoding
- Input/Output
- Substitutions
- String Operation


#### Encoding/Decoding

Encoding/Decoding:

![image](https://github.com/user-attachments/assets/fb35b4ef-3939-4dec-9f10-55b5ce445ba4)


#### Input and Output

Input/Output:

![image](https://github.com/user-attachments/assets/95e7db01-a250-4524-bd6e-07ba9303c8fa)


#### String Operations

String Operation:

![image](https://github.com/user-attachments/assets/62bc6a4b-3090-4d14-9fc9-8e8fac3e52f3)


#### Substitutions

Substitutions:

![image](https://github.com/user-attachments/assets/bace0bb3-4bc4-4039-9cdd-455891ec588b)


#

### Error Handling

Error Handling:
- Useful for scenarios where you expect errors and want to execute specific logic in those cases
- Also useful to handle unexpected error, allows you to exit program gracefuly with friendly error message insetead of code crashing. (What happens if you don't handle error).

- Most language support `try ...catch` blocks
  - A way to implement error handling.
  - All code you want to execute goes into a `try` block;
  - `catch` block contain code you wish to execute if an error occurs.

![image](https://github.com/user-attachments/assets/0603af1d-3164-4912-aa82-f2d295b26009)

- First place all of the code we want to execute in `try` block.
  - Mean if any code fail, program jumps to catch block.
- Inside try block, create an object variable called `$wc`that used to send an HTTP request for a file.
- Next command is used to actually download the file and where to download it on local computer.

Try. . .catch block are not supported by all programming language but supported by most.


#

## Using Bash Script



#

## For The Exam

- Expect to know language used and what script is doing.
- PowerShell and Bash Script use comparison Operators; `-eq` and `-ne` instead of `==` or `!=`.
