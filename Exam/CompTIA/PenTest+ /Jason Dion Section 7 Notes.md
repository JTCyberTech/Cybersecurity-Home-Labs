# Nmap (OBJ 2.3 and 2.4)

# Course Section Summary: Nmap

## Introduction to Nmap
In this section, we will explore Nmap, a versatile security tool used for active reconnaissance, enumeration, and basic vulnerability scanning. Nmap fits into both information gathering and vulnerability scanning phases of engagements, making it a crucial tool to understand.

## Objectives Covered
This section focuses on the following objectives from Domain 2: Information Gathering and Vulnerability Scanning:

- **Objective 2.3**: Analyze the results of a reconnaissance exercise.
- **Objective 2.4**: Perform vulnerability scanning.

## Key Points
1. **Nmap's Versatility**:
    - Nmap can conduct port scanning, service scanning, and vulnerability scanning.
    - The Nmap Scripting Engine (NSE) enhances its capabilities.

2. **Exam Relevance**:
    - Nmap is prominently featured in the PenTest+ exam.
    - You need to know not only what Nmap is but also how to use its syntax and features.
    - Be prepared for in-depth questions on Nmap, including choosing the right options for specific results.

3. **Common Nmap Usage**:
    - Determining the operating system of a target.
    - Reading and interpreting Nmap scan outputs to identify open ports, services, and vulnerabilities.

4. **Nmap's Importance**:
    - It is one of the most essential tools for penetration testers.
    - Understanding Nmap thoroughly will aid significantly on the exam.

5. **Practical Experience**:
    - Practice using Nmap on your Kali virtual machine.
    - Conduct scans on your home network or a lab environment to get comfortable with Nmap and its outputs.

## Scripting and Demonstrations
- The course will cover scripting concepts in Nmap.
- Multiple demonstrations will be provided to show how to conduct scans and analyze results effectively.

## Conclusion
- Mastering Nmap is crucial for success in penetration testing and on the PenTest+ exam.
- Load up Nmap, practice extensively, and familiarize yourself with its outputs.

#

# Nmap Discovery Scans (OBJ 2.3 and 2.4)

# Nmap Lesson Summary

## Introduction to Nmap
Nmap, developed by the Nmap Project, is the world's most popular enumeration tool. It is an open-source security scanner used for network discovery and security auditing.

## Uses of Nmap
- **Port scanning**
- **Topology discovery**
- **Host and service enumeration**
- **Operating system discovery**

## Discovery Scans
- **Basic Usage**: `nmap <IP>` or `nmap <IP range>`
  - Example: `nmap 192.168.1.0/24` scans all 256 IPs in the range.
  - Default behavior: Pings and sends a TCP ACK to ports 80 and 443 to determine host presence, followed by a port scan on the 1,000 most common ports.

## Stealth and Detection Avoidance
- **Host Discovery Scan**: `nmap -sn <IP range>`
  - Suppresses the default 1,000 port scan.
- **List Scan**: `nmap -sL <target range>`
  - Performs reverse DNS queries without touching the host.
- **TCP SYN Ping**: `nmap -PS <ports> <target>`
  - Uses SYN packets for pinging when ICMP is blocked.
- **Sparse Scanning**: `nmap --scan-delay <time> <target>`
  - Adds delays between probes to avoid detection.
- **Scan Timing**: `nmap -Tn <target>`
  - `-T0` (slowest) to `-T5` (fastest) to evade detection.
- **TCP Idle Scan**: `nmap -sI <zombie IP> <target>`
  - Uses a third-party "zombie" host to hide the scan's origin.
- **Fragmentation**: `nmap -f` or `nmap --mtu <size> <target>`
  - Splits TCP headers to avoid detection by IDS/IPS.

## Scan Output Formats
- **Interactive (default)**: Displays results on the screen.
- **Normal File**: `nmap -oN <file>`
- **XML File**: `nmap -oX <file>`
- **Grepable File**: `nmap -oG <file>`

## Example Command
- `nmap -A -T4 scanme.nmap.org`
  - `-T4`: Fast scan timing.

## Exam Tip
- Be comfortable with using Nmap and its various flags.
- Nmap is a key objective in the PenTest+ exam, requiring in-depth knowledge and practical application.

#

# Nmap Port Scans (OBJ 2.3 and 2.4)

## Introduction to Nmap
Nmap is the world's most popular enumeration tool developed by the Nmap Project. It is a versatile port scanner used for topology, host, service, and operating system discovery and enumeration.

## Discovery Scans
- **Basic Syntax**: 
  - `nmap [IP address]` or `nmap [IP range]`
  - Default behavior: pings and sends a TCP acknowledgment packet to ports 80 and 443 to determine if a host is present.
  - If a host is detected, Nmap performs a port scan on the 1,000 most commonly used ports.
- **Host Discovery Scan**: 
  - Use `-sn` flag to perform a host discovery scan without a port scan.
  - Example: `nmap -sn [IP range]`
- **Other Scanning Options**:
  - **List Scan**: `-sL` lists IP addresses and performs a reverse DNS query.
  - **TCP SYN Ping**: `-PS` sends a TCP SYN packet to probe specific ports.
  - **Sparse Scanning**: Use `--scan-delay [time]` to issue probes with delays for stealthiness.
  - **Scan Timing**: `-T[n]` adjusts timing of probes (0 = slowest, 5 = fastest).
  - **TCP ID Idle Scan**: `-sI` makes scans appear to come from another machine (a zombie).
  - **Fragmentation**: `-f` or `--mtu` splits TCP headers to evade detection.

## Fingerprinting and Service Discovery
- **Service Discovery**: Identifies network services and operating systems in use by a target.
- **Port Scanning Techniques**:
  - **TCP SYN Scan**: `-sS` conducts a half-open scan by sending a SYN packet.
  - **TCP Connect Scan**: `-sT` conducts a full three-way handshake.
  - **Null Scan**: `-sN` sends a packet with the header bit set to zero.
  - **FIN Scan**: `-sF` sends an unexpected FIN packet.
  - **Xmas Scan**: `-sX` sends a packet with FIN, PSH, and URG flags set.
  - **UDP Scan**: `-sU` sends a UDP packet and waits for a response or timeout.
  - **Port Ranges**: `-p` specifies the ports to scan.
  
## Port States
- **Open**: An application on the host is ready to accept connections.
- **Closed**: The port responds to probes by sending a reset packet.
- **Filtered**: Nmap can't probe the port, usually due to a firewall.
- **Unfiltered**: Nmap can probe the port but can't determine if it's open or closed.
- **Open/Filtered**: Nmap can't determine if the port is open or filtered.
- **Closed/Filtered**: Nmap can't determine if the port is closed or filtered.

## Importance of Port States
Understanding port states helps identify vulnerabilities and assess the attack surface of a network.

#

# Nmap Fingerprinting (OBJ 2.3 and 2.4)

# Fingerprinting Scans with Nmap

## Overview
In this lesson, we delve deeper into fingerprinting scans, a technique used to gather detailed information about network resources, hosts, and systems. This is crucial for both attackers, who seek to identify potential targets for exploitation, and defenders, who aim to put defenses in place to prevent attacks.

## Fingerprinting Techniques
Once you have identified open ports, use Nmap to perform intense probing:
- **nmap -sV**: Provides basic versioning information.
- **nmap -A**: Conducts a more intensive scan, revealing detailed data.

### Information Gathered
Intensive fingerprint scans can provide:
- Protocols in use
- Application name and version
- Operating system type and version
- Host name
- Device type

## Example Scan Output
A typical scan output includes a list of ports and their states, services running on those ports, version information, MAC addresses, and operating system details.

### Example:
- **Port 53 (TCP)**: Open, running DNS service with Bind (version not identified).
- **Port 80 (TCP)**: Open, running HTTP service with Microsoft IIS 10.0.
- **Additional Information**: MAC address, operating system (e.g., Windows Server 2016).

## How Nmap Identifies Services and Versions
Nmap uses the Common Platform Enumeration (CPE) scheme, developed by MITRE Corporation, to identify hardware devices, operating systems, and applications. The CPE is a database of fingerprint signatures that Nmap compares against responses received from probes.

## Nmap Scripting Engine (NSE)
Nmap's power is enhanced by its Scripting Engine (NSE), which allows detailed probes using scripts written in the Lua scripting language.

### Capabilities of NSE:
- OS detection and platform enumeration
- Windows user account discovery
- Vulnerability detection
- Web server probing for HTTP data and web applications
- Geolocation for traceroute probes

### Resources:
Nmap.org provides many pre-made scripts that can be plugged into your Nmap client, eliminating the need to write scripts yourself.

## Conclusion
Understanding and utilizing fingerprinting scans with Nmap allows both attackers and defenders to gain crucial insights into network systems. By using Nmap's scanning techniques and scripting capabilities, you can gather detailed information to identify vulnerabilities and strengthen your network defenses.


