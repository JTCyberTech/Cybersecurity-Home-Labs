# CompTIA® PenTest+® Certification For Dummies®, 2nd Edition

# Chapter 7: Exploiting ApplicationBased Vulnerabilities

Common Application Based Attacks used to exploit company's applications and systems/data that reside behind those applications.

Also look at common Vuln found within applications, how to identify unsecure coding practices to avoid them.

#

## Looking at Common Application-Based Attacks

### Injection Attacks

- Common types of attacks against applications. Web app are vuln because their audience extended out to internet.
- Injection attack involves hacker accessing application that typically prompts for info; login information or search criteria for product.
- When application prompt for login info, hacker inserts or injects code into the application where the app expects user input.
- Problem: Developers of app may only expect regular "words" to be inserted. Input needs to be validated: testing whether it is safe input that is expected.
- Types: SQL, HTML, command, code injection attacks.

### SQL Injection Attack

- SQL = Structured Query Language; standard database language used to search or retrieve, insert, delete, modify data from database.
- To understand SQLi should understand code developer programmed into Logon button:
  - ` Select * from users where logonname = '$username' and password = '$password'` `
 
![image](https://github.com/user-attachments/assets/0a6a5fbc-c87e-4914-b682-14b34e7e16a0)

Goal
- Goal: To answer, “Is there a user that matches this username and password in our system?”
- SQLi attack just need to create a true condition.
  - Write password to test in password box, but close off the single quote (') to close the single quote that appears in the code of the button.
  - Add condition that is true `1=1`.
  - Add two dashes (--) to comment out any SQL code that the developer would execute when the Logon button is pressed. 
    - Microsoft SQL Servers uses (--); MySQL uses (#) for comment symbol.

' or 1=1 
- ` mypass' or 1=1 -- `: generate true condition.
  - Changing the query from: “Let them in if the username and password is correct", into: “Let them in if the username and password is correct or if 1=1.”
- Validating the input is important: should not accept ' or -- or # in password box; should check data for symbols and not send query to database if they exist.

Semicolon
- Semicolon (;) is needed because it allows you to run multiple commands on single line. Critical for hacker as you typing all of this into the password box.
- Developer should ensure semicolon is not the inpu before data is sent to database server.

### Type of SQLi Attacks

Blind SQL: 
- Attacker submits SQL queries into application that return info about the structure of the database in order to learn more about the target database.

Boolean SQL: 
- SQL query is submitted into application and result that is returned is either true or false.

Stacked Queries: 
  - Attacker uses a UNION statement to join multiple queries together in one command.
  - Result: a single listing made up of results from multiple tables.

![image](https://github.com/user-attachments/assets/a8807e91-a24c-4b8b-bc8f-91cc0bddff1a)

### Protecting Against SQLi Attacks

Sanitization
- SQLi attacks are successful from application allowing data input from user to contain characters that are used to control SQL statements
  - Semicolon `;`, Double dashes `--`
- Sanitization occurs when characters are removed by programmer when the data is submitted into application before input is sent to backend database for processing.

Validation
- Critical for developers to validate the input to ensure it is within scope of expected values.
- Example: if input is supposed to contain number representing quantity of items being purchased; system should check (validate) only number is allow on the input.

Parameterized Queries
- Critical countermeasure to protect against SQLi attack is to use parameterized queries.
- Parameterized query = SQL query that is set up to expect parameter (values) of particular data type that are defined at the beginning of query.
- When query is called, input is passed into parameters where input is `verified` before passing input into SQL startement of query.

#

### HTML Injection Attack

HTML Injection Attack
- Similar concept to SQLi attack
- But HTML code is inserted into application instead of SQL code.
- Typically as part of Cross Site Scripting (XSS) attack.

Goal of HTML injection Attack
- Insert HTML code into form that would get stored in database for app connected.
- If application dev did not validate or sanitize input, its possible for HTML code to be added to Database.
  - Meaning: when someone views the page later, data is read from database, browser will read and execute the new HTML that change the appearance of the page.
  - Hacker could insert HTML code to create a login form for stealing visitor's user and password.

 
### Command Injection Attack

Command Injection Attack
- Hacker insert calls to commands as input in hopes that they can execute commands within the underlining OS.

Example:
- Perl Web Application read contents of file: `http://target_site/cgi-bin/showData.pl?doc=user1.txt`
- If it's vulnerable to command injection, hackers could alter reference to document to reference an executable:
  - `http://target_site/cgi-bin/showData.pl?doc=/bin/ls|`
- PHP environment, can attempt to make call to OS command by appending a semicolon to the end of the URL then referencing OS cammand.
  - `%3B` = `;`, `%20` = space: for URL encoding.
  - Making a call to `cat` command trying to display passwd file: `http://target_site/showData.php?dir=%3Bcat%20/etc/passwd`
 
Key:
- Command injection is that URL contains reference to OS command.
- Not SQL code: select, insert, update or delete command.


### Code Injection Attack

Code Injection Attack
- Hacker inserts application code into application of the language was written in.

Example:
- Web Application: hackers could insert JavaScript into web app causing the app to execute in a way not expected.
- PHP Application: hackers would try to inject PHP code that is used to discover information about the environment.
  - PHP site that is vuln to code injection would show info about PHP setup: `http://target_site/showData.php?id=1;phpinfo()`


#

## For the Exam

- Be able to look at URL and understand what type of attack is being performed.
- SQLi attack; URL would have database code containing `;` and `--` : `http://site/product.php?id=5;update%20products%20set%20price=.50`
  - %20 = URL encoding for a space.
- Know different types of SQLi attacks that can be used during PenTesting.

