# CompTIA® PenTest+® Certification For Dummies®, 2nd Edition

# Chapter 7: Exploiting ApplicationBased Vulnerabilities

Common Application Based Attacks used to exploit company's applications and systems/data that reside behind those applications.

Also look at common Vuln found within applications, how to identify unsecure coding practices to avoid them.

#

## Looking at Common Application-Based Attacks

### Injection Attacks

- Common types of attacks against applications. Web app are vuln because their audience extended out to internet.
- Injection attack involves hacker accessing application that typically prompts for info; login information or search criteria for product.
- When application prompt for login info, hacker inserts or injects code into the application where the app expects user input.
- Problem: Developers of app may only expect regular "words" to be inserted. Input needs to be validated: testing whether it is safe input that is expected.
- Types: SQL, HTML, command, code injection attacks.

### SQL Injection Attack

- SQL = Structured Query Language; standard database language used to search or retrieve, insert, delete, modify data from database.
- To understand SQLi should understand code developer programmed into Logon button:
  - ` Select * from users where logonname = '$username' and password = '$password'` `
 
![image](https://github.com/user-attachments/assets/0a6a5fbc-c87e-4914-b682-14b34e7e16a0)

Goal
- Goal: To answer, “Is there a user that matches this username and password in our system?”
- SQLi attack just need to create a true condition.
  - Write password to test in password box, but close off the single quote (') to close the single quote that appears in the code of the button.
  - Add condition that is true `1=1`.
  - Add two dashes (--) to comment out any SQL code that the developer would execute when the Logon button is pressed. 
    - Microsoft SQL Servers uses (--); MySQL uses (#) for comment symbol.

' or 1=1 
- ` mypass' or 1=1 -- `: generate true condition.
  - Changing the query from: “Let them in if the username and password is correct", into: “Let them in if the username and password is correct or if 1=1.”
- Validating the input is important: should not accept ' or -- or # in password box; should check data for symbols and not send query to database if they exist.

Semicolon
- Semicolon (;) is needed because it allows you to run multiple commands on single line. Critical for hacker as you typing all of this into the password box.
- Developer should ensure semicolon is not the inpu before data is sent to database server.

### Type of SQLi Attacks

Blind SQL: 
- Attacker submits SQL queries into application that return info about the structure of the database in order to learn more about the target database.

Boolean SQL: 
- SQL query is submitted into application and result that is returned is either true or false.

Stacked Queries: 
  - Attacker uses a UNION statement to join multiple queries together in one command.
  - Result: a single listing made up of results from multiple tables.

![image](https://github.com/user-attachments/assets/a8807e91-a24c-4b8b-bc8f-91cc0bddff1a)

### Protecting Against SQLi Attacks

Sanitization
- SQLi attacks are successful from application allowing data input from user to contain characters that are used to control SQL statements
  - Semicolon `;`, Double dashes `--`
- Sanitization occurs when characters are removed by programmer when the data is submitted into application before input is sent to backend database for processing.

Validation
- Critical for developers to validate the input to ensure it is within scope of expected values.
- Example: if input is supposed to contain number representing quantity of items being purchased; system should check (validate) only number is allow on the input.

Parameterized Queries
- Critical countermeasure to protect against SQLi attack is to use parameterized queries.
- Parameterized query = SQL query that is set up to expect parameter (values) of particular data type that are defined at the beginning of query.
- When query is called, input is passed into parameters where input is `verified` before passing input into SQL startement of query.

#

### HTML Injection Attack


#

## For the Exam

- Be able to look at URL and understand what type of attack is being performed.
- SQLi attack; URL would have database code containing `;` and `--` : `http://site/product.php?id=5;update%20products%20set%20price=.50`
  - %20 = URL encoding for a space.
- Know different types of SQLi attacks that can be used during PenTesting.
