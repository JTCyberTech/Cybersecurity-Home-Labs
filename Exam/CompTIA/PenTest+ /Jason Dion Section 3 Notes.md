# Defining the Scope (OBJ 1.2)

## Defining the Scope for Penetration Testing Engagements

Defining the scope of a penetration testing engagement is crucial for effective and cost-efficient assessments. Here’s a summary of key points:

1. **Understand Engagement Objectives**: 
   - Align goals between the client and the tester to set a clear scope.
   
2. **Network Considerations**:
   - Assess both local networks and cloud-based infrastructures.
   - Address challenges of de-perimeterization and cloud migration.
   - Ensure a clear understanding of the client's architecture for known environment tests or guidelines for unknown environment tests.

3. **Cloud Services**:
   - Identify if cloud assets are in scope.
   - Categorize cloud services: 
     - **Software as a Service (SaaS)**: Complete solutions including hardware, OS, and software applications (e.g., Office 365).
     - **Infrastructure as a Service (IaaS)**: Provides hardware, OS, and backend server software with resource elasticity (e.g., cloud-based web server).
     - **Platform as a Service (PaaS)**: Includes hardware and software for specific services (e.g., development platforms for apps).

4. **Application Testing**:
   - Determine web or mobile applications to be tested.
   - Specify the scope by the number or percentage of web pages and user roles (regular, privileged, admin).
   - Understand specific scenarios and platforms (web, Android, iPhone).

5. **Target List**:
   - Identify and document assets in scope and out of scope, including locally hosted, cloud-hosted, and web/mobile applications.
   - Local network, Cloud Server, Web or nobile applications
  
#

# Adversary Emulation (OBJ 1.2) 

## Adversary Emulation and Threat Actor Types

### Importance of Adversary Emulation
Adversary emulation involves mimicking real-world threat actors' tactics, techniques, and procedures during penetration tests. This helps organizations understand their vulnerabilities and prepares them for potential attacks.

### Key Concepts

1. **Threat Actors**:
   - **Script Kiddie**: Least skilled, uses available tools without deep understanding.
   - **Insider Threat**: Employee/former employee with inside knowledge, can be highly dangerous.
   - **Competitor**: Rogue businesses conducting cyber espionage to steal data or damage reputation.
   - **Organized Crime**: Focused on financial gain, uses sophisticated attacks.
   - **Hacktivist**: Politically motivated hackers targeting organizations to advance their agendas.
   - **Nation State/APT**: Highly skilled, well-funded, conducts long-term, covert operations for political, economic, or military objectives.

2. **Threat Actor Tiers**:
   - **Tier 1**: Script kiddies using off-the-shelf tools.
   - **Tier 2**: Hacktivists using basic, self-developed tools.
   - **Tier 3**: Criminal hackers exploiting unknown vulnerabilities.
   - **Tier 4**: Organized crime with advanced technical proficiency.
   - **Tier 5**: Low-end APTs with state sponsorship but not direct state employment.
   - **Tier 6**: High-end APTs, state actors with extensive resources and capability for large-scale operations.

3. **Motivations**:
   - **Greed/Money**: Common among organized crime and ransomware attackers.
   - **Power/Revenge**: Seen in insider threats and some hacktivists.
   - **Thrills/Recognition**: Motivation for script kiddies.
   - **Political/Espionage**: Nation states aiming to further national interests.

### Application in Penetration Testing
- **Simulating Threat Actors**: Model penetration tests based on different threat actors' techniques.
- **Cost and Effort**: High-end simulations (e.g., APTs) require more resources than low-end ones (e.g., script kiddies).
- **Planning and Scoping**: Define objectives, and tailor the assessment to emulate specific threat actors based on the engagement's goals.

### Real-World Examples
- **APT-25**: Mimicking Chinese nation-state actors targeting defense contractors.
- **False Flag Attacks**: Nation states disguising their activities as those of other groups to mislead attribution (e.g., TV5MONDE cyber attack).

### Importance for Organizations
- **Building Defenses**: Knowledge of threat actors helps in developing targeted defenses.
- **Supply Chain Security**: Emphasis on using trusted suppliers to avoid sophisticated attacks (e.g., SolarWinds hack).

By understanding the types and motivations of threat actors, organizations can better prepare for and defend against potential cyber threats.

#

# Target List (OBJ 1.2)

# Importance of Target Selection in Planning and Scoping

As we proceed with planning and scoping for a penetration test, it is essential to identify valid targets for attack. This initial phase is crucial as it forms the foundation of our engagement. Here are the key considerations:

## Internal vs. External Targets
- **Internal Targets**: Located inside the organization's firewall; requires on-site access, VPN access, or exploiting a user’s computer within the network.
- **External Targets**: Publicly facing targets accessible over the internet, such as websites, web applications, email, or DNS servers.

## First Party vs. Third Party Hosted Assets
- **First Party Hosted**: Assets hosted by the organization in their data center.
- **Third Party Hosted**: Assets hosted by external service providers like AWS, Azure, or Google Cloud. Permissions from these providers are necessary.

## Physical Security
- **On-site Assessment**: Testing the physical security measures like guards, cameras, and entry controls.
- **Scope Definition**: Deciding which locations (main office, satellite offices) are included in the assessment.

## User Testing
- **Social Engineering**: Determining if phishing, spear phishing, or other social engineering attacks are allowed.
- **User Scope**: Identifying specific user groups (e.g., excluding executives) for targeting.

## Wireless Networks
- **SSID Identification**: Specifying which wireless networks are in scope.
- **Assessment Techniques**: Deciding on techniques like evil twin or rogue access points.

## Network and Asset Identification
- **IP Addresses and Ranges**: Defining in-scope assets based on IP addresses, network ranges, and ASNs.
- **Domain and Subdomains**: Listing which domains and subdomains are in scope.

## DNS and Server Permissions
- **DNS Targeting**: Clarifying if DNS servers can be modified or if DNS poisoning is allowed.
- **Server Assessment**: Deciding if web server software, databases, and SDKs are included.

## Applications and APIs
- **Application Focus**: Determining if single applications or all applications on a server are in scope.
- **Critical Applications**: Identifying mission-critical applications to exclude from the assessment to avoid downtime.

## Conclusion
Target selection during the planning and scoping phase is vital for a successful penetration test. It ensures that both the penetration tester and the client organization agree on the scope and objectives of the engagement, preventing misunderstandings and ensuring a comprehensive assessment.

#

# Identifying Restriction (OBJ 1.1)

Importance of Risk Tolerance in Penetration Testing

## Understanding Risk Tolerance
Every organization has a different risk tolerance threshold, which will significantly impact the planning, timing, and scope of your penetration testing engagement. This threshold determines how much risk the organization is willing to accept and influences the overall approach to the engagement.

## Impact on Engagement Planning

### Risk-Averse Organizations
- Require extra caution to avoid disruptions.
- May have a smaller scope and tightly controlled engagement.

### Higher Risk Tolerance
- Allows for a larger scope or faster tempo engagement.
- Penetration testers have more leeway in their activities.

## Four Risk Management Strategies
- **Avoid**: Tightly control engagement scope and tempo.
- **Transfer**: Move risk to another entity, e.g., making penetration testers responsible for any damages caused.
- **Mitigate**: Conduct assessments during specific times to minimize impact.
- **Accept**: Organizations with high risk tolerance may accept potential downtime or disruptions.

## Scope and Timing Considerations
- **Impact on Operations**: Understand how disruptions might affect the organization.
- **In-Scope and Out-of-Scope Assets**: Clearly define which assets and systems are included or excluded.
- **Timing and Schedule**: Determine the duration and specific timing for the assessment.

## Avoiding Scope Creep
- **Scope Creep**: When additional services are requested beyond the original agreement.
- **Managing Scope Changes**:
  - Include clauses in contracts for addendums or prearranged costs for additional services.
  - Document all changes as a change order to the statement of work.

## Legal and Regulatory Considerations
- **Location-Based Restrictions**:
  - Be aware of laws and regulations in different countries, states, and cities.
  - Consult with legal counsel to ensure compliance.
- **Tool Restrictions**:
  - Some penetration testing tools are subject to export restrictions, e.g., encryption tools under the Wassenaar Arrangement.
  - Ensure compliance with export controls to avoid fines or imprisonment.

## Summary
Risk tolerance is a crucial factor in penetration testing engagements, affecting scope, timing, and methodology. Organizations must balance the need for thorough assessments with the potential impact on operations. Proper planning, clear communication, and legal compliance are essential to successful and ethical penetration testing.
