# CompTIA® PenTest+® Certification For Dummies®, 2nd Edition

# Chapter 9: Common Penetration Testing Tools

Learn:
- Common PenTest tools
- Their Use Cases
- Introduced to each tools

#

## Understanding Use Cases for Common PenTest Tools

### Reconnaissance

Reconnaissance Tools
- First use case - Information gathering uses reconnaissance tools.
- Two types of reconnaissance: Passive and Active.

Passive Reconniassance:
- Discovering public info available on internet about the Org.
- OSINT to gather info: hosts on internet email addresses, contact names.
  - theHarvester, Maltego, Recon-ng, Shodan, Censys.


Active Reconniassance:
- Engaging with target systems to discover info
- Domain Name System (DNS) lookup, Whois, nslookup, dig
- DNS enumeration with DNSRecon Python scipt.


### Enumeration

Enumeration 
- Another Case Use, also known as scanning and enumeration.
- Use Enumeration tools when discovering detailed info about system on entwork.

Common Tool for Enumeration:
- Nmap: Network Mapper, scanner that perform ping sweeps to tell what systems are up and running,
  - port scans identify ports that are open on each system/ Version of software running on ports.
  - Can also do OS fingerprinting, discover type of OS running on system.
 

### Vulnerability Scanning

Vuln Scanning
- See types of vuln exist on system such as:
  - best practices not being followed
  - Missing patches
  - Misconfiguration of system
 - Great technique to discover weaknesses on a system in order to plan types of attacks you will perform against system during PenTest.
 - Nessus = vuln scanner
 - Nikto and w3af = open source scanners used to identify vuln in websites.


### Credential Attacks

Credential Attacks
- Also known as password attacks
- Used to help discover password for user acc.
- If able to obtain copy of user acc database or password hashe, could use offline password-cracking tools to crack the passwords.
  - Benefit of offline password cracking = Not governed by acc lockout policy if doing cracking offline.
 
Another Techni 
- Brute-Forcing, password cracking service, try every possible password to determine what password is.
- Non-technical: Dumper Diving, going thru garbage to see useful info.


### Persistence

Persistence
- After gaining access to system, Attacker should be sure they can maintain access to system.
  - Can create another method of maintain entry.
 
Ways to maintain access to system:
- Schedule jobs: Create scheduled job or program that would create connection from compromised system to your PenTest system.
- Fake Service: Install fake background service on compromised system, Which allows you to remotely connect to system.
- Trojans: Plant a trojan virus on system so that you can make a connection to trojan port to gain access.
- New Admin Account: Create a new user acc on system to act as backdoor and place that user acc into admin group so you can gain admin access with it.


### Configuration Compliance

Configuration Compliance 
- If PenTest is for compliance reason, need to know specific requirement for environment for compliance.
  - To ensure to test those elements.
 
Example: 
- If company processes credit card info, company must follow list of requirements to ensure security of systems that process and store that info.
- Require system are each on a separate network segment.
- Performing Compliance-based assessment for company, would want to assess network config and ensure credit card processing and storage system are on their own network segment.


### Evasion

Evasion
- Avoids detections
- Limit use of aggressive scans and implement delays between scan attempts to avoid triggering any intrusion detection systems.
- Classic Indication: Same IP address tries to connect to different port on target system over short period of time.


### Decompilaltion and Debugging

Decompilation and Debugging
- Use Decompliation tool to decompile program to review code and look for security weaknesses
- Use Debugger to step thru code and better understand flow of code and what it is doing.

Tools:
- Immunity Debugger: For reverse engineering malware
- GNU Debugger
- GDB (Linux Debugger)
- WinDbg (Windows Debugger)


### Forensics

Forensics
- Use forensics tools to analyse contents of system to identify activity against system.
- Gives capabilities to capture and analyze the contents of memory, hard drive, USB sticks
- Autospy = forensic analysis tool.


### Software Assurance

Software Assurance Testing Tools
- Used to assess security of software application to ensure software is not vuln to attacks that allow hackers to gain access to system.
- PenTester should test software app running on systems to see if there are vuln that can be exploited.

Common Software Assurance Testing Tools:
- Fuzzing
- SAST
- DAST


Fuzzing
- Method to identify poor coding practices in software
- Can use Fuzzer application to send large amount of input into app being tested to see how it responds.
- Fuzzing: process of creating variations of input and sending altered input into app.
- Peach Fuzzer, American Fuzzy Lop (AFL) = Fuzzing tools


SAST
- Static Application Security Testing
- Occurs when security tester review source code of app to ensure dev are following secure coding practices.
- Performed as white box test, given source code to review
- Not running code, just reviewing code.


DAST
- Dynamic Application Security Testing
- PenTester runs app and test functionality of app and how it responds to different input
- Security tester will test app by attempting malicious input such as SQLi code or other forms of malicious injection code.

#

## Looking at Common PenTest Tools

### Scanners 

Scanners
- Different types of Scanners; Some scans for open port, others find vuln within system

Types of Scanners:
- Nmap
- Nikto and w3af
- Nessus
- OpenVAS
- SQLmap
- Open Security Content Automation Protocol (OSCAP)
- Wapiti
- WPScan
- Brakeman
- Scout Suite


#### Nmap

Nmap
- Used to locate system on network and determines open ports on those systems.
- Identify software running on ports and types of OS being used.


#### Nikto and w3af

Nikto
- Open-source Web App vuln scanner
- Nikto perform number of test to determine if web app is vuln to different types of attacks.

To perform Nikto scan against system:
- `nikto -h <IP_or_FQDN>`
- Performing web vuln scan on system with IP or 192.168.1.3
- If web app was using SSL, use: `nikto -h192.168.1.3 -ssl`.

![image](https://github.com/user-attachments/assets/74d4dbd9-a418-4f4b-ba15-e7f14589f310)


w3af
- Another open-source web application vuln scanner
- Web Application Attack and Framework, assess security of web servers.
- Can select different types of vuln to check for by selecting appropriate plug-ins and then starting scan.

![image](https://github.com/user-attachments/assets/d09b6a21-1c16-44e8-854b-603826c1912c)


#### Nessus

Nessus
- Commerical tool used for Vuln scanning of system on network.
- Scan for wide range of vuln, also scan number of different types of devices for those vuln.


#### OpenVAS

OpenVAS
- Open-source vuln scanner
- Perform vuln scan in number of different ways, including authenticated and unauthenticated testing.


#### SQLmap

SQLmap
- Program help automate SQL injection attack against web app you are authorized to test in PenTest.
- To perform automated test with SQLmap, you need to pass in the URL to be tested
  - `sqlmap -u http://192.168.1.3/product.php?id=5`
- The request to page accepts parameter as input and SQLmap will try a number of malicious input on ID parameter.

![image](https://github.com/user-attachments/assets/bcfb57b4-8b74-472f-b871-e0db420aa989)


#### Open Security Content Automation Protocol (OSCAP)

Open Security Content Automation Protocol (OSCAP)
- Framework for automating vuln management and verification of patches.
- Perform automated security configuration review of your systems against benchmark.
- Benchmark = list of requirements that need to be met when check is performed.



#### Wapiti

Wapiti
- Web app vuln scanner that you can use when auditing web app or website.
- Crawl thru content of website and inject data into any forms to test application for vulnerabilities.
- Checks injection vuln, file disclosures, application issues - XSS vulnerabilities.


#### WPScan

WPScan
- WordPress website Scanner
- Looks for vuln in WordPress website.

Perform basic Scan of WordPress to look for common Vuln:
- `wpscan --url website.com`

Scan for vuln plug-in on website:
- `wpscan --url website.com -e vp`
- `-e`: enumerate
- `vp`: vulnerable plug-ins

Get listing of first 100 user accounts exist on site:
- `wpscan --url http://site.com/example -e u[1-100]`

Use wordlist file and crack passwords of those user accounts:
- `wpscan --url http://site.com/example -e u[1-100] --wordlist /usr/share/wordlists/list`


#### Brakeman

Brakeman
- Security scanner for app dev with Ruby on Rails
- Simply look at vuln on running platform and config of the site.
- Look at source code of app to identify vuln


#### Scout Suite

Scout Suite
- Security scanner designed to assess security of cloud environment.
- Uses API calls that expose configuration of cloud environment to identify config setting that may present a security risk.


#

### Credential Testing Tools

Credential Testing Tools
- Tools that help you crack password for user accounts on system.

Type of Credential Testing Tools:
- Hashcat
- Medusa and Hydra
- CeWL
- John the Ripper
- Cain and Abel
- Mimikatz
- Patator and DirBuster


#### Hashcat

Hashcat
- Common password cracking tool for cracking hashes on password.
- MD5, SHA1..
- Can use dictionary attack and brute force attack to crack the password hashes.

Example: 
- `hashcat -m 0 -a 0 -o output.txt target_hashes.txt /usr/share/wordlists/rockyou.txt`
- `-m 0`: specifies hash mode, 0 means MD5, 100 means SHA1
- `-a 0`: specifies attack mode, 0 means dictionary attack.
- `-o`: specifies output files to write cracked passwords to, used output.txt
- `target_hashes.txt`: file that contains the hashes to be cracked.
- `rockyou.txt`: dictionary list file that comes with Kali Linux.


#### Medusa and Hydra

Medusa
- Password cracking rools includes with Kali Linux
- Can use to crack passwords.
- Fast password cracking tool that can encapsulate password attack into different protocols: HTTP, FTP IMAP, MSSQL, POP3 SMTP, TELNET, SSH and more.

Example:
- `medusa -h 192.168.1.3 -u admin -P rockyou.txt -M ssh`
- This will try to crack password for user known as admin on system 192.168.1.3 using SSH as protocol and password list file of rockyou.txt.

Hydra
- Password-cracking tool that can encapsulate attack inside many protocols: FTP, HTTP, HTTPS, LDAP, MS-SQL, MySQL, RDP, POP3, SMB, SSH, and many more.
- Can use it to crack password over RDP.
- Could use Nmap to discover all systems on network running RDP then use Hydra to attempt to crack the admin password.

Example: 
- `nmap -sS 192.168.1.0/24 -p 3389`
- Once discovered the systems running RDP, can then try to crack password with following command:
- `hydra -l administrator -P rockyou.txt rdp://192.168.1.3`
- `-l`: name of the user account to crack, can use -L instead with a text file containing list of users.
- `-P`: specifies password list file to use, used rockyou.txt in this example.
- `rdp://192.168.1.3`: system to crack password on. URL starts with protocol. If you want to crack password over FTP or HTTP, you would simply start URL with those protocol.


#### CeWL

CeWL
- Custom Word List generator
- unique credential cracking tool in the sense that it is used to generate a text tile containing potential passwords by crawling thru site.

Example:
- `cewl -d 2 -m 5 -w words.txt http://www.yourcustomer.com`
- `-d 2`: specifies depth in the  site to go, going two links deep.
- `-m 5`: specifies minimum length of character in words picked up.
- `-w`: specifies file to writes the list of potential password to.


#### John the Ripper

John the Ripper
- Multiplatform password cracking tool thats runs on Windows and Linux.
- Can crack password stored in different hash form: MD5 and SHA.

John package Tools: 
- Mailer: command used to email users who have their password cracked.
- John: command of John the Ripper password cracking tool.
- unafs: Command is used to warn users about their weak passwords.

Example: 
- `john --format=raw-md5 target_hashes.txt`
- `--format`: specifies type of hash value being cracked (MD5 in this example)
- `target_hashes.txt` specifies text file containing the list of hashes.

![image](https://github.com/user-attachments/assets/b7a92956-2ce9-435e-a87e-1e6150f2bb80)

- Can use wordlist file with John the Ripper to perform dictionary attack on password list:
- `john --format=raw-md5 --wordlist rockyou.txt target_hashes.txt`


#### Cain and Abel

Cain and Abel
- Older password cracking tool that has number of features.
- Can easily capture traffic on network then discover password that are sent in clear text
- Also used to crack many different types of password: MD5 hashes, Cisco hashes, Windows Password, and password-protected files.


#### Mimikatz

Mimikatz
- Post exploitation tool on Linux
- Used to steal password off Windows system after system has been exploited.
- Steals passwords by locating passwords stored in memory on exploited system and aids in gaining access to other systems on network.
- Before Windows 10, Windows load encrypted passwords into memeory with feature called WDigest and secret key to decrypt passwords.
- Mimikatz use this and is able to decrypt password.
- In Window 8.1, Microsoft added capability to disable WDigest functionality and it is disabled by default in Windows 10.
  - You can enable it after compromising a system.
 
Example: Mimikatz after exploited a system
- `mimikatz # privilege::debug`: to verify that you have privileges to run command (you must be admin to run Mimikatz)
- `Privilege '20' OK`: return this means you are admin.

Load Sekurlsa module for Mimikatz, retrieve password from memory:
- `mimikatz # sekurlsa::logonpasswords`:
- You will receive list of usernames found in memory with LM hash, NTLM hash and SHA1 hash of the passwor
- Info as the username, domain name, and password in plain text.


#### Patator and DirBuster

Patator and DirBuster
- Patator = password cracking tool that used to crack password given the hash values of password
- DirBuster = Open Web Application Security Project (OWASP) designed to locate directory and filenames on web server.

#

### Debuggers

Debugger
- Tools can help analyze actions taken by particular piece of software.
- Allows you to analyze code of an application to see what applicationis doing underneath the scenes.
- Allow to inspect value of items such as variables while step thru code so you can deteremine type of changes that are occuring when app executes.

Types of Debuggers:
- OllyDbg
- Immunity Debugger
- GDB
- WinDbg
- IDA
- Covenant

OllyDbg:
- Used when you do not have the source code available.
- Allows you to perform binary code anaylsis (analysis on compiled code).

Immunity Debugger: 
- Commoon PenTest tool
- Allows to analyze malware and reverse-engineer binary files.

GDB: 
- GNU debugger, available in Linux.
- Commonand line tool, allows you to inspect area of memory used by program being debugged and monitor code sections that are executing.

WinDbg:
- Debugger built for Windows.
- Can be used to debug apps, device drivers and OS components.

IDA:
- Interactive Disassembler tool
- Allows process an executable program and generate the assembly code from executable.

Covenant:
- Command and control framework with web-based interface that allows you to test the attack surface of a .NET-based application.

#

### Software-Assurance Tools

Software-Assurance Tools:
- Use to test software for weaknesses in design and application code.

Types of Software-Assurance Tools:
- FindBugs/find-sec-bugs
- Peach Fuzzer
- AFL
- SonarQube
- YASCA


FindBugs/Find-sec-bugs
- Static Analysis tools
- Used to review and analyze Java Code.
- Both have plugins that can be added to poplar IDEs; Eclipse or IntelliJ.

Peach Fuzzer:
- Fuzzing Tool designed to test app against different forms of input
- Detect problems in app code.
- Generate a variety of invalid input to send to app to see how it responds to recieving incorrect data.

AFL:
- American Fuzzy Lop
- Fuzzing tool designed to send arbitrary input into app to test for code issues.

SonarQube:
- Automated static code analysis tool that continuously monitors code for bugs and clean code issues.
- Used to test code for variety of coding issues and security practices
- Has wide list of programming lang it can work with.

YASCA:
- Open-source static code Analysis tool designed to detect security vuln within source code.
- Has the benefit of being able to generate a report on results of testing.


#

### Open-Source Intelligence (OSINT) Tools

OSINT Tools:
- Gathering Info from public data sources availabile on Internet.

Types of OSINT Tools:
- Whois
- nslookup
- FOCA
- theHarvester
- Sodan
- Maltego
- Recon-ng
- Censys

Whois:
- Database search tool
- used to search domain info about Org
- Obtain info; technical contact name, phone numbers, email.
- Used to obtain public IP blocks assined to companies.

Nslookup:
- DNS profiling tool used to query DNS server and obtain IP addresses for public systems on internet.
- Can use `dig` in Linux for DNS profiling.

FOCA:
- Fingerprinting Organization with Collected Archives
- OSINT tool used to extract metadata from doc: Microsoft Office doc and PDF files.
- Extract EXIF metadata from graphic files.

theHarvester:
- Used to collect subdomains, email addresses, hostname, IP address of system on internet for company.

Shodan:
- Shows different devices Org has connected to internet and info about those device: Ports that are open and vuln that exist.

Maltego:
- Data-mining tool
- Used in forensics that shows devices connected to internet and their relationship with data from other sources.

Recon-ng:
- Web reconnaissance framework in Linux
- Designed to collect a wealth of info about company from online source and generate a report.

Censys:
- Browser-based search engine
- Identifies hosts on Internet for particular Org.
- Identify services and ports that are open on those system.

#

### Wireless Tools

Type of Wireless Tools
- Aircrack-ng Suite
- Kismet
- Wifite
- Wifite2
- Rogue Access point
- EAPHammer
- mdk4
- Spooftooph
- Reaver
- Wireless Geographic
- Wireless Geographic Logging Engine (WiGLE)
- Fern




#

## For the Exam

- Fuzzing = sending altered input into application to test how it handles different forms of input.
- Nikto = Web app vuln scanner
- SQL = Automated SQLi attack tool
- Nessus = System vuln scanner use to identify weaknesses in a product.
- SCAP = Security scanner deteremines compliance of a system based on benchmark fed into tool.
- WPScan = used to identify vuln in WordPress site
- Scout Suite = used to assess security of cloud-based environment.
- Hashcat, Medusa, Hydra = example of password-cracking tools on Linux.
- John the Ripper and Cain and Abel = Password cracking tools
- Mimikatz is post-exploitation tool that can be used to steal password after gaining admin access to the system.
- Know debugger: OllyDbg, Immunity Debugger, GDB, WinDbg, IDA, Covenant.
- Know Software-Assurance tools: Findbugs/find-sec-bugs, peach fuzzer, AFL, SonarQube, YASCA
- theHarvester, Maltego, Recon-ng = OSINT tools that used to collect info about Org from different source on Internet.
