# CompTIA® PenTest+® Certification For Dummies®, 2nd Edition

# Chapter 11: Reporting and Communication

Learn about wehn and how to update customer on status of PenTest.
- Common remediation steps a customer can take to improve computer and network security of the company.
- Structure of PenTest report, how to deliver report to customer, what types of actions you should perform after the report has been delivered.

## Communicating During a PenTest

Small PenTest taking only a week or two may involve quick update meeting each morning before day starts.

Longer PenTest span over many months may have weekly status meetings with stakeholder.

- Must know who to communicate with during PenTest.
- Authorized person that allowed to commuciate with are determined during "planning and Scoping phase".

#

### Understaning Communication Paths

Individual you should know how to contact:
- Primary Contact: Person designated by customer as individual whom you should report progress of PenTest and any problems.
- Technical Contact: Person you should talk to if you have any technical issues such as needing to add your PenTest System to an approved list to get by security control if needed.
- Emergency Contact: Person you should contact should any major issue arise during PenTest.
  - Example: if system crashes while performing PenTest, you should contact the emergency contact person.
 
Be sure to document name, phone number, email address of each of contacts so you can get in touch when needed.

#

### Communication Triggers

- After determining `who` to communicate.
- Next is to determine `when` to communicate with these stakeholders.
  - Depending on the size of the PenTest but thhere are also events that occurs during PenTest that should cause you to immediately stop PenTest and talk to stakeholders.

Communication Trigger:
- Important events are known as communication triggers.
- Events that trigger you to communicate with stakeholder and get response from customer on how to proceed.

Type of Communication Triggers:
- Critical Finding
- Stages
- Indicators of a prior compromise (Indicator of Compromise [IOC])

#### Critical Findings

- First communciation trigger.
- Occur when you come across a critical or major vuln in system that has customer wide open to attack.
- This case: you do not wait to communicate this important finding to customer in the final report.
- Should stop PenTest immediately and talk to the stakeholder about the critical finding and determine how you are to proceed.


#### Status Reports

- Second communication trigger.
- Occurs at the end of each major stage of the PenTest.
- At the end of each stage of PenTest, you should meet with customer to communicate what is happening at each phase.

Example: 
- After scanning/enumeration of resources, you can let customer know you are now working on performing vuln scans of each system.
- Should be noted that during inital discussions during planning and scoping phase, customer may request status report at regular intervals, completion of each stage as well.


#### Indicators of Prior Compromise (IoC)

- When you come across evidence that shows indications that system has already been compromised during PenTest.
- When you come across system that has evidence it was compromised, its critical to stop PenTest and inform stakeholder about security compromise
  - so they can decide on what action need to take.
- You are the PenTester, not security response team for company.
- Company's Computer Incident Response Team (CIRT) will invoke incident repsonse procedure to deal with security compromise.

Example:
- Come across a backdoor that was created on system that a hacker has planted to allow access into system at later time.


#

### Reasons for Communication

There are other reason beside "Critical Findings" and "Indicator of Compromise" to communicate with customer:
- Situational Awareness
- De-Escalation
- Deconfliction
- Identifying False Positives
- Criminal Activity


#### Situational Awareness

- Benefit of having regualr status update with customer, gives customer opportunity to update the PenTester on any business operations thhat may affect PenTest.

Example:
- Customer may make PenTest team aware of system maintence and scheduled downtime that is currently occurring.


#### De-Escalation

- If a certain phase of PenTest is affecting business operations, customer and PenTester can work together to de-escaalate the situation.
- Ensure business operations go back to normal

Example:
- While Assessing e-commerce site, you cause site to stop responding to clients, which affects business.
- This case: customer may agree to perform e-commerce site testing at different time when site activity is low.
- Customers may also choose to change the parameter of the PenTest and take a different approach with Testing in order to reduce or eliminate impact of PenTest.


#### Deconflication

- When performing PenTest, you may need to implement procedures to prevent security team from conflicting with PenTest.

Example:
- IT security team may block system that generate suspicious traffic from accessing network.
- When performing PenTest, your system may be flagged as being suspicious
- As a result, may be blocked.
- Its important to identify processes to help prevent this conflict between two teams.
  - Solution: Have IP address from PenTesting System whitelisted.

 
#### Identifying False Positives

- If findings appear odd or show as an ongoing compromise
- May initiate communication with customer to verify whether result are inaccurate or false positives.
- False Positive: results appear true but they should be false.

Example:
- Suppose when performing a port scan, it appears that all systems have port 3389 open
- but actually a relay port on firewall redirecting all 3389 traffic to one server that does actually have it open.


#### Criminal Activity

- Comes across evidence of criminaly activity.
- Should report directly to customer to discuss findings.

#

### Goal Reprioritization and Presentation of Findings

- Another reason to meet regularly with customer > if PenTest team comes across new info that may potentially change the goals and priorities of PenTest.
- Goals and priorities are identified during Planning and Scoping phase.
  - Any changes to them would require acceptance from stakeholders.
 
Example:
- Initial focused on SQL server and web application that accesses SQL server.
- After Performing vuln scan on both systems, realized that IIS web server hosting the web app has major vuln compared to SQL server.
- This case: the company may ask you to focus specifically on web app and its vuln.

Presentation:
- Also will meet with sponsoring agent to perform presentation of findings.
- A meeting that summarizes result of PenTest, what systems are vulnerable, what remediation step should be taken.

#

## Findings and Remediations

Expected to understand
- Common Vulnerablities found on system when performing PenTest
- Know typical remediation steops you would recommend for those findings.


### Shared Local Administrator Credentials

Finding: 
- Common security issue: using same password for local admin account of each system.
- Includes admin password on workstations, servers, network devices.

Remediation:
- Recommend for devices with same admin password is to use different passwords on each of the devices.
- Can use randomize credentials tool, generates random password for accounts.
- In Microsoft environment, can use MS's Local Admin Password Solutions (LAPS) tool to manage password for local account of domain-joined computers.
- LAPS is a free tool from MS that will set every admin password to unique password.
  - Also enables you to look up the admin password for any given system.
 
#

### Weak password Complexity

Finding: 
- If number of user accounts use weak passwords.
- Weak passwords are easy to crack with dictionary attack tools and present a huge security violation to network.

Remediations:
- Recommend Org tighten its password policies and enforce minimum password requirements.
- Within password policy:
  - Ensure policy keep track of at least 12 passwords in user's password history
  - Requires regular changes of passwords
  - Enforces a minimum password length of 8 characters
  - Requires password complexity that forces users to use mix of upper and lowercase characters, number, symbols.
  - Applciation can also use password filters that check to ensure strong passwords are being used when users change their passwords.
 
#

### Plain Text Passwords

Finding:
- Many applications store password in files or in database in plain text format.
- Huge security concern, hackers can get either physical or remote access to system and ope nthe file or database.
  -  they will know passwords used by all user of application.
-  Many people also resuse same password across systems and applications.

Remediation:
- Encrypt the password.
- Have dev of application rewrite portion of code that store and retrieve password in encrypted format.
- All sensitive data such as password and customer info; credit card number or SSN should be encrypted on disk and in transit (travels across network).

#

### No MFA

Finding:
- Probelm with Internet App, cloud-based is they allow you to log on from anywhere.
- Meaning: if hackers can figure your password, they can access to internet or cloud baed app and all your data within app.
- Example of internet app includes: web-based email client, cloud environments; Office 365, DNS management tool, social media app.

Remediation:
- Add an extra layer of security to cloud-based app.
- Can implement MFA.
- MFA: hacker must know or have access to some other factor involved in authentication.
- Common factor = smartphone.

#

### SQL Injection

Finding:
- Most web app connect to database to retrieve data that is displayed on web pages.
- Common method hackers use to exploit web app is to perform SQLi attack
  - Hackers inputting commands to server.
  - Hackers will ensure that database commands submitted will help hacker gain access to site or perform mailicous changes on price on products listed.
 
Remediation:
- First step: `Sanitize User Input`.
  - Mean: Before trying to process data submitted to sitem you should sanitize or clean the data.
  - Sanitizing data involves validating input and removing any illegal character that could cause security issues: `--`.
- Also prevent SQLi attack by using: `Parameterize Quries`.
  - Database code stored on database server that website dev call upon that accepts parameters as input.
 
#

### Unnecessary Open Services

Finding:
- During Scanning annd Enumeration Phase: Identify what ports are open on system due to service running.
- Orgs have unnecessary software and services installed on their systems, which opens system up to attack.
- The more software installed/services running = Larger attack surface for hacker.

Remediation:
- Report identify "system hardening" as remeditation step for unnecessary software and services running.
- System Hardening:
  - Removal of unneeded software and disabling unnecessary service on system.
  - Removal of unnecessary user accounts
  - Limiting communication channels with firewalls
  - Encrypting communication with secure protocol such as IPSec.
 
#

## Focusing Your Remediation Strategies

- Should know who or what to focus those mitigation techniques.
- Technology is not always the solution to vuln finding you uncover when doing a PenTest.
- May need to address business processes and educating staff as opposed implementing change in technology.

Example: 
- When doing Social Engineering tests, may have determined that 7 out of 10 users who found your flash drive on floor in office were quick to put the flash drive in their own system to see who's flash drive it was.
- This case: user awareness is the key to prevent this possible attack.
- Solution: focused on people, not tech

Three main Categoriess of Remediation Solutions:
- People
- Process
- Technology


#### People - Remediation Solution

- Critical to educate employees on their responsibilities to security by having a well thought-out and planned security awareness program.
- Program is designed to educate users on importance of topics:
  - Secure password practices
  - Safe Internet surfing practices
  - Safe Email Usage
  - Physical Security awareness
 

 #### Process - Remediation Solution

 - Focused on Business Processes
 - When doing PenTest, may notice there is lack of business processes in certain area of business that could dramatically improve security.

Example: 
- Reduce risk of wasted funds or theft within business, company may have process in place that requres authorization for purchases from lcoal manager
- Then after authorization, written checks are signed by two signing authoriites within business.


#### Technology - Remediation Solution

- More obvious mitigation strategy category over people and processes.
- Find many mitigation recommendations are technology focused.

Example:
- Find that some systems hahve weak passwords,
  - Result: your recommendation would be to implement password policy or password filter that forces employees to create passwords made up of upper and lowercase characters, symbol and number. Minimum of 8 characters in length.
 
#

## Recommending the Appropriate Remediation Strategy

There are number of remediatin techniques that can be formed and divided into categories based on type of controls:
- Technical Controls
- Administrative Controls
- Operational Controls
- Physical Controls

### Common Technical Controls

- Technical Controls also knows as logical controls
- Technology solution put in place to protect an asset from attack.

Common Technical control that can be implemented to help protect system:
- System Hardening
- Sanitize User Input and Parameterize Queries
- Implement Multifactor Authentication
- Encrypt password
- Process-level remediation
- Patch Management
- Key rotation
- Certificate Management
- Secret Management Solution
- Network Segmentation


#### System Hardening

- Help protect system from explotiation
- Hardening refer to removing unnecessary software and user accounts, disabling unnecessary services from system, taking many other actions to lock down system such as implementing strict host-based firewall rules and using policies to prevent from changing system.


#### Sanitize User Input and Parameterized Queries

- Dev should sanitize any input sent to an application.
- Sanitizing input means to check any input delivered to application or application programming interface (API)
  - By eliminating unwanted charcters (escaping them) so they don't do harm to app.
 

#### Implement Maultifactor Authentication

- Ensure web-based app uses MFA.
- MFA ensure that when user log on app with their username and password, they must supply some other proof that they are that user.
- They must type a code that was texted to their smartphone to prove they are that person.


#### Encrypt Password

- Ensure all passwords are encrypted in storage and during authentication process.
- Can use a packet analyzer to analyze logon traffic to verify username and password are not sent across the network in plain text.


#### Process-level Remediation

- Refer to following specific security best practices for specific processes.

Example:
- If you are running web server on system, you would look to disable any add-ons to webserver that you are not using.
- If you have data server hosting data, you would follow best practices; ensuring sensitive data in the database is encrypted and restricting access to different databases on system with permissions.


#### Patch Management

- Ensure all systems are up to data with patches and that there is a process used by company to automate patch deployment.


#### Key Rotation

- Ensure cryptography keys are changed on regular basis.
- Could be passphrases used in symmetric encryption environment; wireless
- Could be setting certificate expiration in public key infrastructure (PKI) environment.


#### Secrets Management Solution

- Ensure managing values of shared secrets on network devices.

Example: 
- Many companies will configure a wireless network with a password (shared secret) and never change it.
- Shared secret should be change on regular basis, so someone with previous knowledge of shared secret cannot connect to the network.


#### Network Segmentation

- Ensure Org is segmenting network in a way that is limiting communication to systems that may contain sensitive information.

Example:
- Should have guest network that cannot communicate with product network.

#

### Common Administrative Controls

Adminstrative Control are policy and procedure instead of technical in nature.

Common Administrative Control that can be put in place to protect assets:
- Role-based Access Control
- Secure Softear Development Life Cycle
- Minimum Password requirements
- Policies and Procedures


#### Role-Based Access Control

- Ensure Role-based access control (RBAC) is used to secure assets.
- RBAC = permissions are assigned to a role such as admin and user.

Example:
- SQL servers uses RBAC and has role called `DataReaderWriter` that you can assign to a user that needs to be able to read write to all tables in database.


#### Secure Software Development Life Cycle

- Ensure programmers follow the secure software development life cycle
- Implement security at all phases of application life cycle.


#### Minimum Password Requirement

- Ensure that users are forced to follow minimum password requirements
- Many systems and applications have policy settings that can be used to enforce maximum password age, password history, password complexity


#### Policies and Procedures

- Ensure there is security policy within the Org and verify that it is being actively maintained.

#

### Common Operational Control

- Operational Control helps maintain integrity on the job.

Operational Controls:
- Job Rotation
- Time of day Restrictions
- Mandatory Vacations
- User Training


#### Job Rotation

- A security principle that has employees change job positions on regular basis.
- Ensures that multiple people can perform each job task
- But more important, it can be used to detect fradulent activity by previous employee in that job position.


#### Time of day Restriction

- Involves limiting access to facility or network resources to hours of work shift.


#### Mandatory Vacations

- Recommend companies have a mandatory vacation polict that states emplotees must take time off certain number of days per year.
- While employee is off, someone else performs employee's job tasks.
- Helps detect any wrongdoing on job or fraudulent activity.


#### User Training

- Ensure that employees recieve proper training to perform their job tasks.
- Ensure that company has mandatory cybersecurity awareness sessions that are taken on regular basis.

#

### Common Physical Control

Type of Physical Controls:
- Access Control Vestibule
- Biometric Control
- Video Surveillnace


#### Access Control Vestibule

- Also known as Mantrap
- Used to ensure only authorized people are entering facility.
- An area between two locked doors where the internal door is not unlocked until person authenticated to system and until exterior door is closed and locked.


#### Biometric Controls

- Used to authenticate to system using characteristics of person such as voice recognition, retina scan or finger print.


#### Video Surveillance

- Camera set up thru out the facility to monitor activity within facility and at all entrance and exits.

#

## Writing and Handling PenTest Report

Need to familiarity with different sections of report:
- What goes into report
- How to securely store an transmit the report

### Common Themes/Root Causes

- Helpful to focus on common themes or root cause of how you gained access to target systems.

Common Themes to focus:
- Vulnerabilities
- Observation
- Lack of best practices


### Vulnerabilities

- Report should discuss type of vuln found on systems and devices and how to remediate those systems.


#### Observations

- Should identify any observation made

Example: 
- Notice that encryption is being used, but maybe best algorithm for the job is not being used.


#### Lack of best practices

- Report should identify any security practices that are not being followed
- Could be holes in physical security, lack of technical control, policy element missing.

#

### Notetaking and Normalization of data

- Should document steps during PenTest so you can include them in report.
- Take screenshots within PenTest report.
- Ongoing documentation during PenTest and taking screenshots will help when you write report at the end of PenTest process.

#

### Risk Appetite

- Refers to level of risk an organization is willing to accept,
- Important to understand Org's risk appetite because you will need to prioritize PenTest results and provide remediation steps to customer based on Org's risk tolerance.
- Recommendations on remediation steps will stem from results of vuln scan and exploitation
  - But, should also align with Org's risk appetite.
- Risk appetite will depend on function of Org.

Example: 
- If its an Org that affects public safety then risk appetite (tolerance) will be low.

#

### Report Audience



#

## For The Exam

- Emergency event = critical findings, determine one of the company's assest has been compromised.
  - Communication Path: Important to identify who to approach when such event occur during PenTest
- Types of Communication Trigger: Critical findings, Status Report (Stage), Indicator of Compromise (IoC)
  - With Critical Findings and indicators of prior compromise > Stop PenTest and present info to stakeholder.
