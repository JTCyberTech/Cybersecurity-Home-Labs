# Configurating The Credentials for Credential Scan

Credential scanning in Nessus involves using valid login credentials to assess a system's security. It is crucial because it provides a more comprehensive evaluation of vulnerabilities by accessing deeper system information and enables the identification of risks that might be missed in non-credential scans. This approach enhances security assessments, aids in accurate risk prioritization, and helps organizations proactively address potential threats.

We will incorporate credentials into our Windows Scan saved on Nessus to enhance the depth of information retrieved during the scanning process.

<h2></h2>

- Navigate to My Scans and select the Windows saved scan.

<p align="center">
<br/>
<img src="https://i.imgur.com/zufihNk.png" height="60%" width="60%" alt=""/>
<br />

- On the top right corner of the page, Click on "Configure".

<p align="center">
<br/>
<img src="https://i.imgur.com/V2cCq06.png" height="60%" width="60%" alt=""/>
<br />

- Click on the "Credentials" section.

<p align="center">
<br/>
<img src="https://i.imgur.com/GTQDQaz.png" height="60%" width="60%" alt=""/>
<br />

- Select "Windows" under SSH.

<p align="center">
<br/>
<img src="https://i.imgur.com/VdHbbYj.png" height="60%" width="60%" alt=""/>
<br />

- When configurating Windows Credentials, there are four different authentication methods to choose from stated below.
  - Password method: Requires the administrator or user password to be provided for authentication.
  - Kerberos method: Used when the target system is joined to a domain.
  - LM Hash and NTLM Hash Method: Used to perform authenticated scans.

<p align="center">
<br/>
<img src="https://i.imgur.com/PmBJxfg.png" height="60%" width="60%" alt=""/>
<br />

- We will look at the Password method for now.
  - We will need to fill in our username, password and domain name of our VM then click Save.
 
<p align="center">
<br/>
<img src="https://i.imgur.com/kQyCyht.png" height="60%" width="60%" alt=""/>
<br />

<h2></h2>

If you forgot your username and domain name for your VM.
- You can go to command prompt on Window VM and type in: whoami

<p align="center">
<br/>
<img src="https://i.imgur.com/emA2IZI.png" height="60%" width="60%" alt=""/>
<br />

<h2></h2>

A notification that the account used doesn't have the necessary privileges might appear if you try to run the scan.

This occurs because the non-default administrator account is automatically included in the local administrators group but lacks the necessary permissions to access all system files and settings.

You will need to apply these steps for Nessus to work.

- Go to the Windows VM > Go to the Windows Start Menu and search for services.

<p align="center">
<br/>
<img src="https://i.imgur.com/1gnzo3j.png" height="60%" width="60%" alt=""/>
<br />

- Scroll down and find "Remote Registry" and click on it.

<p align="center">
<br/>
<img src="https://i.imgur.com/Nr9eBtb.png" height="60%" width="60%" alt=""/>
<br />

- Change the Startup type from "Disable" to "Automatic". Then Click Apply and OK.

<p align="center">
<br/>
<img src="https://i.imgur.com/xtoakj4.png" height="60%" width="60%" alt=""/>
<br />

- Go to the Windows Start Menu and search for "Change User Account Control settings".

<p align="center">
<br/>
<img src="https://i.imgur.com/nGavHvS.png" height="60%" width="60%" alt=""/>
<br />

- Change the setting to "Never notify". Then OK.
  - This will prevent user account control prompts from interrupting our scan.

<p align="center">
<br/>
<img src="https://i.imgur.com/GccKboy.png" height="60%" width="60%" alt=""/>
<br />

- Go to the Windows Start Menu and search for "Registry Editor". Right click on it and Run as Administrator.

<p align="center">
<br/>
<img src="https://i.imgur.com/68vwxTo.png" height="60%" width="60%" alt=""/>
<br />

- Click to expand on HKEY_LOCAL_MACHINE.

<p align="center">
<br/>
<img src="https://i.imgur.com/jMhJhTL.png" height="30%" width="30%" alt=""/>
<br />

- Click to expand on SOFTWARE.

<p align="center">
<br/>
<img src="https://i.imgur.com/8elnENf.png" height="30%" width="30%" alt=""/>
<br />

- Click to expand on MICROSOFT.

<p align="center">
<br/>
<img src="https://i.imgur.com/Yhc52kE.png" height="60%" width="60%" alt=""/>
<br />

- Scroll down and click to expand on Windows.

<p align="center">
<br/>
<img src="https://i.imgur.com/beZxJdW.png" height="30%" width="30%" alt=""/>
<br />

- Click to expand on CurrentVersion.

<p align="center">
<br/>
<img src="https://i.imgur.com/jJS52I3.png" height="60%" width="60%" alt=""/>
<br />

- Scroll down and click to expand Policies.

<p align="center">
<br/>
<img src="https://i.imgur.com/FXiMlbK.png" height="60%" width="60%" alt=""/>
<br />

- Click to expand on System.

<p align="center">
<br/>
<img src="https://i.imgur.com/rarcWhQ.png" height="60%" width="60%" alt=""/>
<br />

- Go to the right side of screen and right click and click on new > DWORD (32-bit) value.
  - This will create a new registry value.

<p align="center">
<br/>
<img src="https://i.imgur.com/UezAkBk.png" height="30%" width="30%" alt=""/>
<br />

- Rename the new registry value exactly: "LocalAccountTokenFilterPolicy"

<p align="center">
<br/>
<img src="https://i.imgur.com/EZcqk9j.png" height="60%" width="60%" alt=""/>
<br />

- Double click on the DWORD vaule to change the policy.
  - Change the Value data from "0" to "1" then click on OK.

<p align="center">
<br/>
<img src="https://i.imgur.com/yyMCylC.png" height="30%" width="30%" alt=""/>
<br />
 
This action activates the local account token filter policy, granting non-administrator accounts permission to access administrative resources within the system. When using remote procedure call.

Restart the VM to ensure the change is made.

Once this adjustment is placed, Nessus will leverage credential scanning capabilities to conduct thorough and comprehensive security assessments of your system.
